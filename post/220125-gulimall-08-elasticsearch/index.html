<!DOCTYPE html>
<html><head>
<meta name="google-site-verification" content="XrwF-xUZWSGJVBBm7jM8vqemVqx--zo5Tb9d-Vr7BCc" />
<title>ElasticSearchËàáSpringÊï¥Âêà</title>




<meta charset="utf-8">
<meta name="X-UA-Compatible" content="IE=edge">
<meta name="google-site-verification" content="">
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
<meta content="telephone=no" name="format-detection">
<meta name="description" content="SpringBootÂæÆÊúçÂãôÈ†ÖÁõÆÁ≠ÜË®ò-08">
<meta name="renderer" content="webkit">
<meta name="theme-color" content="#ffffff">



<meta property="og:title" content="ElasticSearchËàáSpringÊï¥Âêà" />
<meta property="og:description" content="SpringBootÂæÆÊúçÂãôÈ†ÖÁõÆÁ≠ÜË®ò-08" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://yoziming.github.io/post/220125-gulimall-08-elasticsearch/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2022-01-25T00:00:00+00:00" />
<meta property="article:modified_time" content="2022-01-25T00:00:00+00:00" /><meta property="og:site_name" content="My Blog" />






<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="ElasticSearchËàáSpringÊï¥Âêà"/>
<meta name="twitter:description" content="SpringBootÂæÆÊúçÂãôÈ†ÖÁõÆÁ≠ÜË®ò-08"/>







<link type="text/css" rel="stylesheet" href="/vendor/css/bootstrap.min.css">


  




<link rel="icon" href="https://yoziming.github.io/images/favicon.png">



<link rel="stylesheet" href="https://yoziming.github.io/scss/journal.min.3f72a5fc8f5b5dd732a4b476aced0eece2156958d9d414316494ddb10593ddf7.css" integrity="sha256-P3Kl/I9bXdcypLR2rO0O7OIVaVjZ1BQxZJTdsQWT3fc=" media="screen">



<link rel="stylesheet" href="https://yoziming.github.io/scss/dark-mode.min.f7c2efa7183435a6bd1842f91c541481c7a5137b5991629a870f24e4a516ad4b.css" integrity="sha256-98Lvpxg0Naa9GEL5HFQUgcelE3tZkWKahw8k5KUWrUs=" media="screen">


<script src="/vendor/js/loadCSS.js"></script>
<script>
  loadCSS("https://fonts.googleapis.com/css?family=Fira+Mono|Material+Icons");
</script>






  <script src="/js/toc.js"></script>











<script src="//cdn.jsdelivr.net/npm/@waline/client/dist/Waline.min.js"></script>





</head>
<body>
    	<div id="app"><div id="sideContainer" class="side-container">
    
    <a class="a-block nav-head false" href="https://yoziming.github.io/">
    
        <div class="nav-title">
            ÊüöÂ≠êËå∂ÂÆ§
        </div>
        
        <div class="nav-subtitle">
            Á¥ÄÈåÑËá™Â≠∏Â§ßÂ∞è‰∫ã
        </div>
        
    </a>

    <div class="nav-link-list">
        
        
            
            
            
                
            
            
            
            <a class="a-block nav-link-item active" href="/">
                È¶ñÈ†Åüè†
            </a>
            
        
            
            
            
            
            
            <a class="a-block nav-link-item false" href="/tags">
                Ê®ôÁ±§üè∑Ô∏è
            </a>
            
        
            
            
            
            
            
            <a class="a-block nav-link-item false" href="/categories">
                Á≥ªÂàóÊñáüìñ
            </a>
            
        
            
            
            
            
            
            <a class="a-block nav-link-item false" href="/about-me">
                ÈóúÊñºÊàëüê£
            </a>
            
        
    </div>

    

    <div class="nav-footer">
        
Hugo Theme <a href="https://github.com/amazingrise/hugo-theme-diary">Diary</a> by <a href="https://amazingrise.net">Rise</a>
<br>
ÁßªÊ§çËá™ <a href="https://mak1t0.cc/" target="_blank" rel="noreferrer noopener">Makito</a>'s <a href="https://github.com/SumiMakito/hexo-theme-journal/" target="_blank" rel="noreferrer noopener">Journal.</a> <br>
<br>

&copy;
	
	Yoziming
	

    </div>
    
</div><div id="extraContainer" class="extra-container">
    
    
    <div class="toc animated-visibility" :class="{ invisible: scrollY <= 140 }">


	<div class="toc-content">
	
		
		
		
		<center>- ÁõÆÈåÑ -</center>
		
		
		<ul>
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#elasticsearch" onclick="onNavClick(`#elasticsearch-nav`)" id="elasticsearch-nav">
									ElasticSearch
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#%e5%ae%89%e8%a3%9d" onclick="onNavClick(`#ÂÆâË£ù-nav`)" id="ÂÆâË£ù-nav">
									ÂÆâË£ù
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#%e6%b8%ac%e8%a9%a6" onclick="onNavClick(`#Ê∏¨Ë©¶-nav`)" id="Ê∏¨Ë©¶-nav">
									Ê∏¨Ë©¶
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#%e4%bd%bf%e7%94%a8" onclick="onNavClick(`#‰ΩøÁî®-nav`)" id="‰ΩøÁî®-nav">
									‰ΩøÁî®
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#%e5%bb%ba%e7%ab%8b%e4%b8%80%e5%80%8bdocument" onclick="onNavClick(`#Âª∫Á´ã‰∏ÄÂÄãdocument-nav`)" id="Âª∫Á´ã‰∏ÄÂÄãdocument-nav">
									Âª∫Á´ã‰∏ÄÂÄãDocument
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#put%e8%88%87post%e6%9b%b4%e6%96%b0" onclick="onNavClick(`#putËàápostÊõ¥Êñ∞-nav`)" id="putËàápostÊõ¥Êñ∞-nav">
									PUTËàáPOSTÊõ¥Êñ∞
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e6%9f%a5%e8%a9%a2" onclick="onNavClick(`#Êü•Ë©¢-nav`)" id="Êü•Ë©¢-nav">
									Êü•Ë©¢
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%88%aa" onclick="onNavClick(`#Âà™-nav`)" id="Âà™-nav">
									Âà™
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#bulk%e6%89%b9%e6%ac%a1%e6%93%8d%e4%bd%9c" onclick="onNavClick(`#bulkÊâπÊ¨°Êìç‰Ωú-nav`)" id="bulkÊâπÊ¨°Êìç‰Ωú-nav">
									bulkÊâπÊ¨°Êìç‰Ωú
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#kibana" onclick="onNavClick(`#kibana-nav`)" id="kibana-nav">
									kibana
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#search-api" onclick="onNavClick(`#search-api-nav`)" id="search-api-nav">
									Search Api
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#%e8%a3%9c%e5%85%85-sql%e6%96%b9%e5%bc%8f%e6%9f%a5%e8%a9%a2" onclick="onNavClick(`#Ë£úÂÖÖ-sqlÊñπÂºèÊü•Ë©¢-nav`)" id="Ë£úÂÖÖ-sqlÊñπÂºèÊü•Ë©¢-nav">
									Ë£úÂÖÖ: SQLÊñπÂºèÊü•Ë©¢
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#query-dsl" onclick="onNavClick(`#query-dsl-nav`)" id="query-dsl-nav">
									Query DSL
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#%e5%8c%b9%e9%85%8d%e6%9f%a5%e8%a9%a2" onclick="onNavClick(`#ÂåπÈÖçÊü•Ë©¢-nav`)" id="ÂåπÈÖçÊü•Ë©¢-nav">
									ÂåπÈÖçÊü•Ë©¢
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#match-%e5%8c%b9%e9%85%8d" onclick="onNavClick(`#match-ÂåπÈÖç-nav`)" id="match-ÂåπÈÖç-nav">
									match ÂåπÈÖç
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#match_phrase-%e7%9f%ad%e5%8f%a5%e5%8c%b9%e9%85%8d" onclick="onNavClick(`#match_phrase-Áü≠Âè•ÂåπÈÖç-nav`)" id="match_phrase-Áü≠Âè•ÂåπÈÖç-nav">
									match_phrase Áü≠Âè•ÂåπÈÖç
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#multi_match-%e5%a4%9a%e5%ad%97%e6%ae%b5%e5%8c%b9%e9%85%8d" onclick="onNavClick(`#multi_match-Â§öÂ≠óÊÆµÂåπÈÖç-nav`)" id="multi_match-Â§öÂ≠óÊÆµÂåπÈÖç-nav">
									multi_match Â§öÂ≠óÊÆµÂåπÈÖç
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#term-%e7%b2%be%e7%a2%ba%e5%8c%b9%e9%85%8d" onclick="onNavClick(`#term-Á≤æÁ¢∫ÂåπÈÖç-nav`)" id="term-Á≤æÁ¢∫ÂåπÈÖç-nav">
									term Á≤æÁ¢∫ÂåπÈÖç
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#%e8%a4%87%e5%90%88%e6%9f%a5%e8%a9%a2" onclick="onNavClick(`#Ë§áÂêàÊü•Ë©¢-nav`)" id="Ë§áÂêàÊü•Ë©¢-nav">
									Ë§áÂêàÊü•Ë©¢
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#bool-%e6%a2%9d%e4%bb%b6%e5%88%a4%e6%96%b7" onclick="onNavClick(`#bool-Ê¢ù‰ª∂Âà§Êñ∑-nav`)" id="bool-Ê¢ù‰ª∂Âà§Êñ∑-nav">
									bool Ê¢ù‰ª∂Âà§Êñ∑
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#filter-%e7%b5%90%e6%9e%9c%e9%81%8e%e6%bf%be" onclick="onNavClick(`#filter-ÁµêÊûúÈÅéÊøæ-nav`)" id="filter-ÁµêÊûúÈÅéÊøæ-nav">
									filter ÁµêÊûúÈÅéÊøæ
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#aggregation-%e5%9f%b7%e8%a1%8c%e8%81%9a%e5%90%88" onclick="onNavClick(`#aggregation-Âü∑Ë°åËÅöÂêà-nav`)" id="aggregation-Âü∑Ë°åËÅöÂêà-nav">
									aggregation Âü∑Ë°åËÅöÂêà
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#%e5%ad%90%e8%81%9a%e5%90%88" onclick="onNavClick(`#Â≠êËÅöÂêà-nav`)" id="Â≠êËÅöÂêà-nav">
									Â≠êËÅöÂêà
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
								</ul>
							
						
						
						
							<li>
								<a href="#mapping" onclick="onNavClick(`#mapping-nav`)" id="mapping-nav">
									Mapping
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#%e6%8c%87%e5%ae%9amapping" onclick="onNavClick(`#ÊåáÂÆömapping-nav`)" id="ÊåáÂÆömapping-nav">
									ÊåáÂÆömapping
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#%e5%88%86%e8%a9%9e" onclick="onNavClick(`#ÂàÜË©û-nav`)" id="ÂàÜË©û-nav">
									ÂàÜË©û
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#%e5%ae%89%e8%a3%9dik%e5%88%86%e8%a9%9e%e5%99%a8" onclick="onNavClick(`#ÂÆâË£ùikÂàÜË©ûÂô®-nav`)" id="ÂÆâË£ùikÂàÜË©ûÂô®-nav">
									ÂÆâË£ùikÂàÜË©ûÂô®
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e8%87%aa%e5%ae%9a%e7%be%a9%e8%a9%9e%e5%ba%ab" onclick="onNavClick(`#Ëá™ÂÆöÁæ©Ë©ûÂ∫´-nav`)" id="Ëá™ÂÆöÁæ©Ë©ûÂ∫´-nav">
									Ëá™ÂÆöÁæ©Ë©ûÂ∫´
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
								</ul>
							
						
						
						
							<li>
								<a href="#%e6%95%b4%e5%90%88spring" onclick="onNavClick(`#Êï¥Âêàspring-nav`)" id="Êï¥Âêàspring-nav">
									Êï¥ÂêàSpring
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#%e6%b8%ac%e8%a9%a6%e9%80%a3%e7%b7%9a" onclick="onNavClick(`#Ê∏¨Ë©¶ÈÄ£Á∑ö-nav`)" id="Ê∏¨Ë©¶ÈÄ£Á∑ö-nav">
									Ê∏¨Ë©¶ÈÄ£Á∑ö
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e6%aa%a2%e7%b4%a2%e7%af%84%e4%be%8b" onclick="onNavClick(`#Ê™¢Á¥¢ÁØÑ‰æã-nav`)" id="Ê™¢Á¥¢ÁØÑ‰æã-nav">
									Ê™¢Á¥¢ÁØÑ‰æã
								</a>
							</li>
						
						
					
				
			
		</ul>
	</div>

</div>
    
    <div class="pagination">
        <a id="globalBackToTop" class="pagination-action animated-visibility" href="#top" :class="{ invisible: scrollY == 0 }">
            <i class="material-icons pagination-action-icon">
                keyboard_arrow_up
            </i>
        </a>
        
        <a type="button" class="pagination-action" id="darkModeToggleButton">
            <span class="material-icons pagination-action-icon" id="darkModeToggleIcon">
                dark_mode
            </span>
        </a>
        
        
    </div>
</div>
<div class="single-column-drawer-container" id="drawer"
     v-bind:class="{ 'single-column-drawer-container-active': isDrawerOpen }">
    <div class="drawer-content">
        <div class="drawer-menu">
            
            
            
                
                
                
                    
                
                
                
                <a class="a-block drawer-menu-item active" href="/">
                    È¶ñÈ†Åüè†
                </a>
                
            
                
                
                
                
                
                <a class="a-block drawer-menu-item false" href="/tags">
                    Ê®ôÁ±§üè∑Ô∏è
                </a>
                
            
                
                
                
                
                
                <a class="a-block drawer-menu-item false" href="/categories">
                    Á≥ªÂàóÊñáüìñ
                </a>
                
            
                
                
                
                
                
                <a class="a-block drawer-menu-item false" href="/about-me">
                    ÈóúÊñºÊàëüê£
                </a>
                
            
            
            <div class="toc">


	<div class="toc-content">
	
		
		
		
		<center>- ÁõÆÈåÑ -</center>
		
		
		<ul>
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#elasticsearch" onclick="onNavClick(`#elasticsearch-nav`)" id="elasticsearch-nav">
									ElasticSearch
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#%e5%ae%89%e8%a3%9d" onclick="onNavClick(`#ÂÆâË£ù-nav`)" id="ÂÆâË£ù-nav">
									ÂÆâË£ù
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#%e6%b8%ac%e8%a9%a6" onclick="onNavClick(`#Ê∏¨Ë©¶-nav`)" id="Ê∏¨Ë©¶-nav">
									Ê∏¨Ë©¶
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#%e4%bd%bf%e7%94%a8" onclick="onNavClick(`#‰ΩøÁî®-nav`)" id="‰ΩøÁî®-nav">
									‰ΩøÁî®
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#%e5%bb%ba%e7%ab%8b%e4%b8%80%e5%80%8bdocument" onclick="onNavClick(`#Âª∫Á´ã‰∏ÄÂÄãdocument-nav`)" id="Âª∫Á´ã‰∏ÄÂÄãdocument-nav">
									Âª∫Á´ã‰∏ÄÂÄãDocument
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#put%e8%88%87post%e6%9b%b4%e6%96%b0" onclick="onNavClick(`#putËàápostÊõ¥Êñ∞-nav`)" id="putËàápostÊõ¥Êñ∞-nav">
									PUTËàáPOSTÊõ¥Êñ∞
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e6%9f%a5%e8%a9%a2" onclick="onNavClick(`#Êü•Ë©¢-nav`)" id="Êü•Ë©¢-nav">
									Êü•Ë©¢
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%88%aa" onclick="onNavClick(`#Âà™-nav`)" id="Âà™-nav">
									Âà™
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#bulk%e6%89%b9%e6%ac%a1%e6%93%8d%e4%bd%9c" onclick="onNavClick(`#bulkÊâπÊ¨°Êìç‰Ωú-nav`)" id="bulkÊâπÊ¨°Êìç‰Ωú-nav">
									bulkÊâπÊ¨°Êìç‰Ωú
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#kibana" onclick="onNavClick(`#kibana-nav`)" id="kibana-nav">
									kibana
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#search-api" onclick="onNavClick(`#search-api-nav`)" id="search-api-nav">
									Search Api
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#%e8%a3%9c%e5%85%85-sql%e6%96%b9%e5%bc%8f%e6%9f%a5%e8%a9%a2" onclick="onNavClick(`#Ë£úÂÖÖ-sqlÊñπÂºèÊü•Ë©¢-nav`)" id="Ë£úÂÖÖ-sqlÊñπÂºèÊü•Ë©¢-nav">
									Ë£úÂÖÖ: SQLÊñπÂºèÊü•Ë©¢
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#query-dsl" onclick="onNavClick(`#query-dsl-nav`)" id="query-dsl-nav">
									Query DSL
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#%e5%8c%b9%e9%85%8d%e6%9f%a5%e8%a9%a2" onclick="onNavClick(`#ÂåπÈÖçÊü•Ë©¢-nav`)" id="ÂåπÈÖçÊü•Ë©¢-nav">
									ÂåπÈÖçÊü•Ë©¢
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#match-%e5%8c%b9%e9%85%8d" onclick="onNavClick(`#match-ÂåπÈÖç-nav`)" id="match-ÂåπÈÖç-nav">
									match ÂåπÈÖç
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#match_phrase-%e7%9f%ad%e5%8f%a5%e5%8c%b9%e9%85%8d" onclick="onNavClick(`#match_phrase-Áü≠Âè•ÂåπÈÖç-nav`)" id="match_phrase-Áü≠Âè•ÂåπÈÖç-nav">
									match_phrase Áü≠Âè•ÂåπÈÖç
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#multi_match-%e5%a4%9a%e5%ad%97%e6%ae%b5%e5%8c%b9%e9%85%8d" onclick="onNavClick(`#multi_match-Â§öÂ≠óÊÆµÂåπÈÖç-nav`)" id="multi_match-Â§öÂ≠óÊÆµÂåπÈÖç-nav">
									multi_match Â§öÂ≠óÊÆµÂåπÈÖç
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#term-%e7%b2%be%e7%a2%ba%e5%8c%b9%e9%85%8d" onclick="onNavClick(`#term-Á≤æÁ¢∫ÂåπÈÖç-nav`)" id="term-Á≤æÁ¢∫ÂåπÈÖç-nav">
									term Á≤æÁ¢∫ÂåπÈÖç
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#%e8%a4%87%e5%90%88%e6%9f%a5%e8%a9%a2" onclick="onNavClick(`#Ë§áÂêàÊü•Ë©¢-nav`)" id="Ë§áÂêàÊü•Ë©¢-nav">
									Ë§áÂêàÊü•Ë©¢
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#bool-%e6%a2%9d%e4%bb%b6%e5%88%a4%e6%96%b7" onclick="onNavClick(`#bool-Ê¢ù‰ª∂Âà§Êñ∑-nav`)" id="bool-Ê¢ù‰ª∂Âà§Êñ∑-nav">
									bool Ê¢ù‰ª∂Âà§Êñ∑
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#filter-%e7%b5%90%e6%9e%9c%e9%81%8e%e6%bf%be" onclick="onNavClick(`#filter-ÁµêÊûúÈÅéÊøæ-nav`)" id="filter-ÁµêÊûúÈÅéÊøæ-nav">
									filter ÁµêÊûúÈÅéÊøæ
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#aggregation-%e5%9f%b7%e8%a1%8c%e8%81%9a%e5%90%88" onclick="onNavClick(`#aggregation-Âü∑Ë°åËÅöÂêà-nav`)" id="aggregation-Âü∑Ë°åËÅöÂêà-nav">
									aggregation Âü∑Ë°åËÅöÂêà
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#%e5%ad%90%e8%81%9a%e5%90%88" onclick="onNavClick(`#Â≠êËÅöÂêà-nav`)" id="Â≠êËÅöÂêà-nav">
									Â≠êËÅöÂêà
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
								</ul>
							
						
						
						
							<li>
								<a href="#mapping" onclick="onNavClick(`#mapping-nav`)" id="mapping-nav">
									Mapping
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#%e6%8c%87%e5%ae%9amapping" onclick="onNavClick(`#ÊåáÂÆömapping-nav`)" id="ÊåáÂÆömapping-nav">
									ÊåáÂÆömapping
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#%e5%88%86%e8%a9%9e" onclick="onNavClick(`#ÂàÜË©û-nav`)" id="ÂàÜË©û-nav">
									ÂàÜË©û
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#%e5%ae%89%e8%a3%9dik%e5%88%86%e8%a9%9e%e5%99%a8" onclick="onNavClick(`#ÂÆâË£ùikÂàÜË©ûÂô®-nav`)" id="ÂÆâË£ùikÂàÜË©ûÂô®-nav">
									ÂÆâË£ùikÂàÜË©ûÂô®
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e8%87%aa%e5%ae%9a%e7%be%a9%e8%a9%9e%e5%ba%ab" onclick="onNavClick(`#Ëá™ÂÆöÁæ©Ë©ûÂ∫´-nav`)" id="Ëá™ÂÆöÁæ©Ë©ûÂ∫´-nav">
									Ëá™ÂÆöÁæ©Ë©ûÂ∫´
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
								</ul>
							
						
						
						
							<li>
								<a href="#%e6%95%b4%e5%90%88spring" onclick="onNavClick(`#Êï¥Âêàspring-nav`)" id="Êï¥Âêàspring-nav">
									Êï¥ÂêàSpring
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#%e6%b8%ac%e8%a9%a6%e9%80%a3%e7%b7%9a" onclick="onNavClick(`#Ê∏¨Ë©¶ÈÄ£Á∑ö-nav`)" id="Ê∏¨Ë©¶ÈÄ£Á∑ö-nav">
									Ê∏¨Ë©¶ÈÄ£Á∑ö
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e6%aa%a2%e7%b4%a2%e7%af%84%e4%be%8b" onclick="onNavClick(`#Ê™¢Á¥¢ÁØÑ‰æã-nav`)" id="Ê™¢Á¥¢ÁØÑ‰æã-nav">
									Ê™¢Á¥¢ÁØÑ‰æã
								</a>
							</li>
						
						
					
				
			
		</ul>
	</div>

</div>
            
        </div>
    </div>
</div>
<transition name="fade">
    <div id="drawer-mask" v-bind:class="{ 'single-column-drawer-mask': mounted }" v-if="isDrawerOpen" v-on:click="toggleDrawer"></div>
</transition>
<nav id="navBar" class="navbar sticky-top navbar-light single-column-nav-container">
    <div id="navBackground" class="nav-background"></div>
    <div class="container container-narrow nav-content">
        <button id="nav_dropdown_btn" class="nav-dropdown-toggle" type="button" v-on:click="toggleDrawer">
            <i class="material-icons">
                menu
            </i>
        </button>
        <a id="navTitle" class="navbar-brand" href="https://yoziming.github.io/">
            ÊüöÂ≠êËå∂ÂÆ§
        </a>
        
        <button type="button" class="nav-darkmode-toggle" id="darkModeToggleButton2">
            <i class="material-icons" id="darkModeToggleIcon2">
                dark_mode
            </i>
        </button>
        
    </div>
</nav>
<div class="single-column-header-container" id="pageHead"
     v-bind:style="{ transform: 'translateZ(0px) translateY('+.3*scrollY+'px)', opacity: 1-navOpacity }">
    <a href="https://yoziming.github.io/">
        <div class="single-column-header-title">ÊüöÂ≠êËå∂ÂÆ§</div>
        
        <div class="single-column-header-subtitle">Á¥ÄÈåÑËá™Â≠∏Â§ßÂ∞è‰∫ã</div>
        

    </a>
</div>

            <div id="content">
                <div id="streamContainer" class="stream-container">

    <div class="post-list-container post-list-container-shadow">
        <div class="post">
            
            
            
                
            

            <div class="post-head-wrapper"
                
                    
                    
                    style="background-image: url('https://yoziming.github.io/images/elasticsearch.jpg')"
                    
                
            >
                <div class="post-title">
                    ElasticSearchËàáSpringÊï¥Âêà
                    
                    <div class="post-subtitle">
                        SpringBootÂæÆÊúçÂãôÈ†ÖÁõÆÁ≠ÜË®ò-08
                    </div>
                    
                    <div class="post-meta">
                        
                        <time itemprop="datePublished">
                            2022-01-25 00:00
                        </time>
                        

                        
                            <i class="material-icons" style="">folder</i>
                                <a href="/categories/java%E5%BE%AE%E6%9C%8D%E5%8B%99%E5%B0%88%E6%A1%88">JavaÂæÆÊúçÂãôÂ∞àÊ°à</a>
                                &nbsp;
                        

                        
                            <i class="material-icons" style="">label</i>
                            
                                <a href="/tags/nosql">NoSQL</a>
                                &nbsp;
                            
                                <a href="/tags/docker">Docker</a>
                                &nbsp;
                            
                        
                        
                    </div>
                </div>
            </div>
            
            <div class="post-body-wrapper">
                
                <div class="post-body" v-pre>
                
                    <h1 id="elasticsearch">ElasticSearch</h1>
<blockquote>
<p>Áî®‰æÜÂü∑Ë°åÁ´ôÂÖßÊêúÁ¥¢(Â¶ÇÂïÜÂìÅÊü•Ë©¢)ÁöÑÂºïÊìé</p>
</blockquote>
<ul>
<li>ÈñãÊ∫êÁöÑÂàÜÊï£ÂºèÊêúÂ∞ãÂºïÊìéÔºåÂü∫ÊñºApache LuceneÔºå‰ΩÜÊòØÂ∞ÅË£ùÊàêREST APIÔºåÊñπ‰æøÊìç‰Ωú</li>
<li>Ê†∏ÂøÉËßÄÂøµ: Inverted Index (ÂèçÂêëÁ¥¢Âºï)</li>
<li>ÊòØ NoSQL Ë≥áÊñôÂ∫´ÁöÑ‰∏ÄÁ®ÆÔºåÊâÄÊúâÁöÑË≥áÊñôÈÉΩÊòØ‰ª• JSON ÁöÑÊñπÂºèÈÄ≤Ë°åÂ≠òÂèñ</li>
<li>ÂêçË©ûÂ∞çÊáâ:</li>
</ul>
<table>
<thead>
<tr>
<th><strong>RDBMS</strong></th>
<th>Ê¶ÇÂøµ</th>
<th><strong>Elasticsearch</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Table</td>
<td>Ë°®</td>
<td>Index</td>
</tr>
<tr>
<td>Row</td>
<td>‰∏ÄÁ≠ÜË≥áÊñô(‰æãÂ¶Ç:Âºµ‰∏â)</td>
<td>Document</td>
</tr>
<tr>
<td>Column</td>
<td>Â±¨ÊÄß(‰æãÂ¶Ç:ÂßìÂêç)</td>
<td>Field</td>
</tr>
<tr>
<td>Schema</td>
<td>Êû∂Êßã(‰æãÂ¶Ç:Ë≥áÊñôÈ°ûÂûã„ÄÅÂÖÅË®±ÁÇ∫Á©∫Á≠âÁ≠â)</td>
<td>Mapping</td>
</tr>
<tr>
<td>SQL</td>
<td>Êìç‰ΩúË™ûÂè•</td>
<td>DSL</td>
</tr>
</tbody>
</table>
<ul>
<li>‰ª•ÂâçÂèØËÉΩÊúâ‰∫∫ÊúÉË™™IndexÂ∞çÊáâdatabaseÔºåtypeÊâçÊòØÂ∞çÊáâË°®Ôºå‰ΩÜÂú®ES7ÁâàÂæåTypeÂ∑≤Á∂ìÂπæ‰πéË¢´Ê£ÑÁî®</li>
<li>ÂÄã‰∫∫Áõ¥Êé•ÊääÂÆÉÁúã‰ΩúË°®‰∫ÜÔºåÁï¢Á´üÊòØÊ¶ÇÂøµÔºå‰∏çÁî®ÂàÜÂ§™Á¥∞</li>
</ul>
<h2 id="ÂÆâË£ù">ÂÆâË£ù</h2>
<blockquote>
<p>‰ΩøÁî®docker</p>
</blockquote>
<ul>
<li>ÊïôÂ≠∏ÁöÑ‰ªñË®≠ÂÆöÊéõËºâ‰ΩçÁΩÆËàáÊèí‰ª∂Ë∑ØÂæëÔºå‰∏¶ÂèñÂæóÊ¨äÈôêÁ≠âÁ≠âÔºåÊñπ‰æøÂæåÁ∫åÊìç‰Ωú</li>
</ul>
<pre tabindex="0"><code>mkdir -p /mydata/elasticsearch/config
mkdir -p /mydata/elasticsearch/data
echo &#34;http.host: 0.0.0.0&#34; &gt;/mydata/elasticsearch/config/elasticsearch.yml
chmod -R 777 /mydata/elasticsearch/
</code></pre><ul>
<li>‰∫åÂêà‰∏ÄÈè°ÂÉè: <a href="https://hub.docker.com/r/nshou/elasticsearch-kibana">https://hub.docker.com/r/nshou/elasticsearch-kibana</a>
<ul>
<li>ÁõÆÂâç2022Âπ¥1ÊúàÊòØ7.16.2Êùø</li>
<li>ÊàëÁõ¥Êé•Áî®docker desktopÔºåÂ∞±Ê≤íÊéõËºâÈÇ£È∫ºÂ§ö</li>
</ul>
</li>
</ul>
<pre tabindex="0"><code>docker pull nshou/elasticsearch-kibana

docker run --name elasticsearch -p 5601:5601 -p 9200:9200 -e  &#34;discovery.type=single-node&#34; -e ES_JAVA_OPTS=&#34;-Xms64m -Xmx512m&#34; -d nshou/elasticsearch-kibana
</code></pre><ul>
<li><code>--name</code> ÂèñÂêç</li>
<li><code>-e &quot;discovery.type=single-node&quot;</code>  ÂñÆÁØÄÈªûÊ®°Âºè</li>
<li><code>-e ES_JAVA_OPTS=&quot;-Xms64m -Xmx512m&quot;</code> ÈôêÂà∂Ë®òÊÜ∂È´îÔºå‰∏çÈôêÊúÉÂç†Áî®Ë∂ÖÂ§ö</li>
<li><code>-p</code> ÈÄ£Êé•Èòú
<ul>
<li>Elasticsearch @ localhost:9200</li>
<li>Kibana @ localhost:5601</li>
</ul>
</li>
<li><code>-d</code> ÂæåÂè∞ÈÅãË°å‰∏¶ËøîÂõûid</li>
</ul>
<h3 id="Ê∏¨Ë©¶">Ê∏¨Ë©¶</h3>
<ul>
<li>ÂòóË©¶ÁúãÁúãKibana‰ªãÈù¢ÔºåË®™Âïè: localhost:5601</li>
<li>Êü•Áúã‰∏ªÊúçÂãôÂÅ•Â∫∑: http://localhost:9200/_cat/health</li>
</ul>
<h2 id="‰ΩøÁî®">‰ΩøÁî®</h2>
<ul>
<li>Êü•ÁúãÁ¥¢Âºï: http://localhost:9200/_cat/indices
<ul>
<li>Áõ∏Áï∂Êñºshow databasesÊàñtables</li>
</ul>
</li>
</ul>
<h3 id="Âª∫Á´ã‰∏ÄÂÄãdocument">Âª∫Á´ã‰∏ÄÂÄãDocument</h3>
<ul>
<li>‰ΩøÁî®PUTË´ãÊ±Ç http://localhost:9200/customer/external/1
<ul>
<li>‰∏¶‰∏îÂ∏∂ÊúâbodyË≥áË®ä</li>
</ul>
</li>
</ul>
<p><img src="image-20220118235447277.png" alt="image-20220118235447277"></p>
<ul>
<li>
<p>ËøîÂõûÁöÑÊòØmetadataÔºåÂæåË®≠Ë≥áÊñôÔºåÈÄô‰∫õ<code>_</code>ÈñãÈ†≠ÁöÑÂ∞±ÊòØË≥áÊñôÁöÑË≥áÊñô</p>
<ul>
<li><code>_index</code>Ôºödocument ÊâÄÂ±¨ÁöÑ index ÂêçÁ®±ÔºåÁõ∏Áï∂Êñº&quot;Ë°®&quot;</li>
<li><code>_type</code>Ôºödocument È°ûÂûã ÔºåÈÄöÂ∏∏ÁÇ∫<code>_doc</code></li>
<li><code>_id</code>Ôºödocument IDÔºå‰∏ªÈçµ</li>
<li><code>_source</code>Ôºödocument ÁöÑÂéüÂßã JSON Ë≥áÊñôÊ®£Ë≤å</li>
<li><code>_version</code>ÔºöÁâàÊú¨Ë®äÊÅØ (ÊúâÈÄôÊ¨Ñ‰ΩçÂ∞±Ë°®Á§∫ ES ÂÖ∑ÊúâÁâàÊú¨ÊéßÁÆ°ÁöÑËÉΩÂäõ)</li>
<li><code>_score</code>ÔºöÊü•Ë©¢ÊôÇÁöÑÁÆóÂàÜÁµêÊûú (ÊØèÊ¨°ÁöÑÊêúÂ∞ãÈÉΩÊúÉÊ†πÊìö document Â∞çÊñºÊêúÂ∞ãÂÖßÂÆπÁöÑÁõ∏ÈóúÂ∫¶ÈÄ≤Ë°åÁÆóÂàÜ)</li>
</ul>
</li>
<li>
<p><code>index</code> Âú® ES ‰∏≠ÊòØÂÄãÈÇèËºØÁ©∫ÈñìÁöÑÊ¶ÇÂøµÔºåÁî®‰æÜÂÑ≤Â≠ò document ÁöÑÂÆπÂô®ÔºåËÄåÈÄô‰∫õ document ÂÖßÂÆπÈÉΩÊòØÁõ∏‰ººÁöÑ (Ë∑üÂÖ∂‰ªñÈ†òÂüüÁöÑ index Áî®Ê≥ï‰∏çÂ§™‰∏ÄÊ®£)</p>
</li>
<li>
<p><code>shard</code> Âú® ES ‰∏≠ÂâáÊòØÂÄãÁâ©ÁêÜÁ©∫ÈñìÁöÑÁöÑÊ¶ÇÂøµÔºåindex ‰∏≠ÁöÑË≥áÊñôÊúÉÂàÜÊï£ÊîæÂú®‰∏çÂêåÁöÑ shard ‰∏≠</p>
</li>
</ul>
<h3 id="putËàápostÊõ¥Êñ∞">PUTËàáPOSTÊõ¥Êñ∞</h3>
<ul>
<li>PUTÂøÖÈ†àÊåáÂÆöIDÔºåÂ¶ÇÊûúÂ≠òÂú®ÂâáÊõ¥Êñ∞(Ë¶ÜËìãÊõ¥Êñ∞)
<ul>
<li>ËàáRESTË¶èÂâáÁõ∏Á¨¶ÔºåPUTÊòØÂÜ™Á≠âÔºåÂç≥Â§öÊ¨°Êìç‰ΩúÁµêÊûúËøîÂõûÁõ∏Âêå(ÊØèÊ¨°ÈÉΩÊúÉÊï¥ÂÄãÂà∑Êñ∞ÁöÑÊÑèÊÄù)</li>
</ul>
</li>
<li>POST‰∏çÂøÖÊåáÂÆöIDÔºåÂ¶ÇÊûú‰∏çÂ≠òÂú®Â∞±Âª∫Á´ãÔºåÂ∑≤Â≠òÂú®Â∞±Êõ¥Êñ∞
<ul>
<li>‰ΩÜÊòØÂ¶ÇÊûúË≥áÊñôÈÉΩÊ≤íËÆäÂãïÔºåÂ∞±‰∏çÊõ¥Êñ∞Ôºå‰∏îÊúÉËøîÂõû&quot;noop&quot;</li>
</ul>
</li>
</ul>
<h3 id="Êü•Ë©¢">Êü•Ë©¢</h3>
<ul>
<li>
<p>‰ΩøÁî®GETË´ãÊ±Ç http://localhost:9200/customer/external/1</p>
<ul>
<li>‰∏¶‰∏î‰∏çËÉΩÊúâbody</li>
</ul>
</li>
<li>
<p>ËøîÂõû</p>
</li>
</ul>
<pre tabindex="0"><code>    &#34;_version&#34;: 1,
    &#34;_seq_no&#34;: 0,
    &#34;_primary_term&#34;: 1,
</code></pre><p><code>_seq_no</code> ÊØèÊ¨°Êõ¥Êñ∞ÈÉΩÊúÉ+1ÔºåÁî®‰æÜÂÅöÊ®ÇËßÄÈéñ</p>
<p><code>_primary_term</code> Áï∂‰∏ªÂàÜÁâáÈáçÊñ∞ÂàÜÈÖçÔºåÂ¶ÇÈáçÂïüÂ∞±ÊúÉËÆäÂåñ</p>
<h3 id="Âà™">Âà™</h3>
<ul>
<li>Â∞±DELETEÔºåÂèØ‰ª•ÊåáÂÆöIDÔºåÊàñÊï¥ÂÄãindexÂÖ®Âà™</li>
<li>Ê≤íËæ¶Ê≥ïÂà™Èô§type</li>
</ul>
<h3 id="bulkÊâπÊ¨°Êìç‰Ωú">bulkÊâπÊ¨°Êìç‰Ωú</h3>
<ul>
<li>ÊØèÊ¢ùË™ûÊ≥ïÁç®Á´ãÔºåÂÖ∂‰∏≠ÊúâË™∞Â§±Êïó‰∏çÂΩ±ÈüøÂÖ∂‰ªñ‰∫∫</li>
<li>ÁØÑ‰æã:</li>
</ul>
<pre tabindex="0"><code>POST customer/external/_bulk
{&#34;index&#34;:{&#34;_id&#34;:&#34;1&#34;}}
{&#34;name&#34;:&#34;John Doe&#34;}
{&#34;index&#34;:{&#34;_id&#34;:&#34;2&#34;}}
{&#34;name&#34;:&#34;John Doe&#34;}
</code></pre><h2 id="kibana">kibana</h2>
<blockquote>
<p>ËàíÊúçÁöÑÂèØË¶ñÂåñÊìç‰Ωú‰ªãÈù¢</p>
</blockquote>
<ul>
<li>
<p>ÈÄ£Á∑öÂà∞: localhost:5601</p>
</li>
<li>
<p>Â∞éÂÖ•Ê∏¨Ë©¶Êï∏Êìö:</p>
</li>
<li>
<p><a href="https://github.com/elastic/elasticsearch/blob/v7.4.2/docs/src/test/resources/accounts.json">https://github.com/elastic/elasticsearch/blob/v7.4.2/docs/src/test/resources/accounts.json</a></p>
</li>
</ul>
<pre tabindex="0"><code>POST bank/account/_bulk
(ÂéªgithubË§áË£ΩË≤ºÂà∞ÈÄô)
</code></pre><p><img src="image-20220119003426307.png" alt="image-20220119003426307"></p>
<h2 id="search-api">Search Api</h2>
<blockquote>
<p>ÂÖ©Á®ÆÂü∫Êú¨Ê™¢Á¥¢ÊñπÂºè</p>
</blockquote>
<ul>
<li>ÈÄöÈÅéREST request uri ÁôºÈÄÅÊêúÁ¥¢ÂèÉÊï∏ Ôºàuri +Ê™¢Á¥¢ÂèÉÊï∏Ôºâ</li>
</ul>
<pre tabindex="0"><code>GET bank/_search?q=*&amp;sort=account_number:asc
</code></pre><ul>
<li>ÈÄöÈÅéREST request body ‰æÜÁôºÈÄÅÂÆÉÂÄëÔºàuri+Ë´ãÊ±ÇÈ´îÔºâ
<ul>
<li>Âè™ËÉΩÁî®Âú®dev toolÔºå‰∏ÄËà¨HTTP‰∏çÁµ¶‰Ω†ÁôºGETÂ∏∂bodyÁöÑ</li>
<li>Âú®kibana dev_toolsÁî®ctrl + enterÂÅöÁÇ∫Âü∑Ë°åÁöÑÂø´Êç∑Èçµ</li>
</ul>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2">GET</span> <span style="color:#a61717;background-color:#e3d2d2">/bank/_search</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#8b008b;font-weight:bold">&#34;query&#34;</span>: { <span style="color:#8b008b;font-weight:bold">&#34;match_all&#34;</span>: {} },
</span></span><span style="display:flex;"><span>  <span style="color:#8b008b;font-weight:bold">&#34;sort&#34;</span>: [
</span></span><span style="display:flex;"><span>    { <span style="color:#8b008b;font-weight:bold">&#34;account_number&#34;</span>: <span style="color:#cd5555">&#34;asc&#34;</span> },
</span></span><span style="display:flex;"><span>    {<span style="color:#8b008b;font-weight:bold">&#34;balance&#34;</span>:<span style="color:#cd5555">&#34;desc&#34;</span>}
</span></span><span style="display:flex;"><span>  ]
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ul>
<li>
<p>ËøîÂõûÁöÑÂÄº</p>
<ul>
<li><code>hits</code> ÁµêÊûúÊï∏Èáè</li>
<li><code>_score</code> ÂæóÂàÜ(Â≠ó‰∏≤ÊØîÂ∞çÁöÑÂæóÂàÜ)</li>
</ul>
</li>
</ul>
<h3 id="Ë£úÂÖÖ-sqlÊñπÂºèÊü•Ë©¢">Ë£úÂÖÖ: SQLÊñπÂºèÊü•Ë©¢</h3>
<ul>
<li>ÊàëÂæå‰æÜÊâçÁü•ÈÅìES 6.3‰ª•ÂæåÂéüÁîüÊîØÊåÅÁî®SQLÊñπÂºè‰æÜÊü•Ôºå‰æãÂ¶Ç:</li>
</ul>
<pre tabindex="0"><code>POST /_sql?format=txt
{
  &#34;query&#34;: &#34;SELECT account_number,address,age,balance FROM account LIMIT 10&#34;
}
</code></pre><ul>
<li>Â∞çÊñº‰∏ÄËà¨‰ΩøÁî®‰æÜË™™ÂÆåÂÖ®Ë∂≥Â§†‰∫ÜÔºåÊúâÈúÄË¶ÅÊ∑±Â∫¶‰ΩøÁî®ÂÜçÂ≠∏DSLÂêß</li>
<li>ÂèÉËÄÉ : <a href="http://www.macrozheng.com/#/reference/elasticsearch_sql_start">http://www.macrozheng.com/#/reference/elasticsearch_sql_start</a></li>
</ul>
<h2 id="query-dsl">Query DSL</h2>
<ul>
<li>ElasticsearchÊèê‰æõ‰∫Ü‰∏ÄÂÄãÂèØ‰ª•Âü∑Ë°åÊü•Ë©¢ÁöÑJsonÈ¢®Ê†ºÁöÑDSL„ÄÇÈÄôÂÄãË¢´Á®±ÁÇ∫Query DSLÔºåË©≤Êü•Ë©¢Ë™ûË®ÄÈùûÂ∏∏ÂÖ®Èù¢„ÄÇ‰æãÂ¶Ç:</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2">QUERY_NAME:</span>{
</span></span><span style="display:flex;"><span>   <span style="color:#a61717;background-color:#e3d2d2">ARGUMENT:VALUE,</span>
</span></span><span style="display:flex;"><span>   <span style="color:#a61717;background-color:#e3d2d2">ARGUMENT:VALUE,...</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#a61717;background-color:#e3d2d2">QUERY_NAME:{</span>
</span></span><span style="display:flex;"><span>     <span style="color:#a61717;background-color:#e3d2d2">FIELD_NAME:{</span>
</span></span><span style="display:flex;"><span>       <span style="color:#a61717;background-color:#e3d2d2">ARGUMENT:VALUE,</span>
</span></span><span style="display:flex;"><span>       <span style="color:#a61717;background-color:#e3d2d2">ARGUMENT:VALUE,...</span>
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>   <span style="color:#a61717;background-color:#e3d2d2">}</span>
</span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2">GET</span> <span style="color:#a61717;background-color:#e3d2d2">bank/_search</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#8b008b;font-weight:bold">&#34;query&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">&#34;match_all&#34;</span>: {}
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  <span style="color:#8b008b;font-weight:bold">&#34;from&#34;</span>: <span style="color:#b452cd">0</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#8b008b;font-weight:bold">&#34;size&#34;</span>: <span style="color:#b452cd">5</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#8b008b;font-weight:bold">&#34;sort&#34;</span>: [
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#8b008b;font-weight:bold">&#34;account_number&#34;</span>: {
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">&#34;order&#34;</span>: <span style="color:#cd5555">&#34;desc&#34;</span>
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  ]
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2">GET</span> <span style="color:#a61717;background-color:#e3d2d2">bank/_search</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#8b008b;font-weight:bold">&#34;query&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">&#34;match_all&#34;</span>: {}
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  <span style="color:#8b008b;font-weight:bold">&#34;from&#34;</span>: <span style="color:#b452cd">0</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#8b008b;font-weight:bold">&#34;size&#34;</span>: <span style="color:#b452cd">5</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#8b008b;font-weight:bold">&#34;sort&#34;</span>: [
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#8b008b;font-weight:bold">&#34;account_number&#34;</span>: {
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">&#34;order&#34;</span>: <span style="color:#cd5555">&#34;desc&#34;</span>
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  ],
</span></span><span style="display:flex;"><span>  <span style="color:#8b008b;font-weight:bold">&#34;_source&#34;</span>: [<span style="color:#cd5555">&#34;balance&#34;</span>,<span style="color:#cd5555">&#34;firstname&#34;</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ul>
<li><code>match_all</code> ‰ª£Ë°®Êü•Ë©¢ÊâÄÊúâÔºåes‰∏≠ÂèØ‰ª•Âú®<code>query</code>‰∏≠ÁµÑÂêàÈùûÂ∏∏Â§öÁöÑÊü•Ë©¢È°ûÂûãÂÆåÊàêË§áÈõúÊü•Ë©¢</li>
<li><code>from</code> + <code>size</code> ÈôêÂÆöËøîÂõûÊï∏ÈáèÔºåÂÆåÊàêÂàÜÈ†ÅÂäüËÉΩ</li>
<li><code>sort</code> ÊéíÂ∫èÔºåÂèØ‰ª•Â§öÈáçÊéíÂ∫è(Ââç‰∏ÄÂÄãÈ†Ü‰ΩçÁõ∏Á≠âÊôÇ)</li>
<li><code>_source</code> Âè™ÊÉ≥ËøîÂõûÊüê‰∫õÂ±¨ÊÄß</li>
</ul>
<h3 id="ÂåπÈÖçÊü•Ë©¢">ÂåπÈÖçÊü•Ë©¢</h3>
<h4 id="match-ÂåπÈÖç">match ÂåπÈÖç</h4>
<ul>
<li>‰æãÂ¶ÇÂåπÈÖçÊüêÂÄºÁ≠âÊñºÂ§öÂ∞ë</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2">GET</span> <span style="color:#a61717;background-color:#e3d2d2">bank/_search</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#8b008b;font-weight:bold">&#34;query&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">&#34;match&#34;</span>: {
</span></span><span style="display:flex;"><span>      <span style="color:#8b008b;font-weight:bold">&#34;account_number&#34;</span>: <span style="color:#cd5555">&#34;20&#34;</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ul>
<li>‰πüÂèØ‰ª•Ê®°Á≥äÂåπÈÖçÔºåÊúÉÈÄ≤Ë°åÂàÜË©ûÂåπÈÖç‰∏¶‰æùÁÖßÂæóÂàÜÊéíÂ∫èËøîÂõû
<ul>
<li>ÊúÉÁî®AviationÊü•„ÄÅÁî®RoadÊü•ÔºåÁÑ∂ÂæåÊúÄÊé•ËøëAviation RoadÁöÑÊúÉÊéíÂú®ÂâçÈù¢</li>
</ul>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2">GET</span> <span style="color:#a61717;background-color:#e3d2d2">bank/_search</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#8b008b;font-weight:bold">&#34;query&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">&#34;match&#34;</span>: {
</span></span><span style="display:flex;"><span>      <span style="color:#8b008b;font-weight:bold">&#34;address&#34;</span>: <span style="color:#cd5555">&#34;Aviation Road&#34;</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h4 id="match_phrase-Áü≠Âè•ÂåπÈÖç">match_phrase Áü≠Âè•ÂåπÈÖç</h4>
<ul>
<li>‰∏çËÉΩÊãÜÂàÜÔºå‰∏ÄÂÆöË¶ÅÂåÖÂê´ÂÆåÊï¥ÁöÑ<code>Aviation Road</code>
<ul>
<li>‰ΩÜÊòØÂèØ‰ª•Êõ¥Èï∑Ôºå‰æãÂ¶ÇËøîÂõûÁöÑÁµêÊûúÊòØ <code>2123 Aviation Road xxx</code></li>
</ul>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2">GET</span> <span style="color:#a61717;background-color:#e3d2d2">bank/_search</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#8b008b;font-weight:bold">&#34;query&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">&#34;match_phrase&#34;</span>: {
</span></span><span style="display:flex;"><span>      <span style="color:#8b008b;font-weight:bold">&#34;address&#34;</span>: <span style="color:#cd5555">&#34;Aviation Road&#34;</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h4 id="multi_match-Â§öÂ≠óÊÆµÂåπÈÖç">multi_match Â§öÂ≠óÊÆµÂåπÈÖç</h4>
<ul>
<li>addressÊàñcity‰∏≠ÂåÖÂê´&quot;mill&quot;ÁöÑ
<ul>
<li>‰πüËÉΩÂ§öÊü•Ë©¢Â≠óÔºå‰æãÂ¶Ç&quot;mill road&quot;Â∞±ÊúÉË∑üÂâçÈù¢Ê®°Á≥äÂåπÈÖç‰∏ÄÊ®£ÂàÜË©û</li>
</ul>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2">GET</span> <span style="color:#a61717;background-color:#e3d2d2">bank/_search</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#8b008b;font-weight:bold">&#34;query&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">&#34;multi_match&#34;</span>: {
</span></span><span style="display:flex;"><span>      <span style="color:#8b008b;font-weight:bold">&#34;query&#34;</span>: <span style="color:#cd5555">&#34;mill &#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#8b008b;font-weight:bold">&#34;fields&#34;</span>: [<span style="color:#cd5555">&#34;address&#34;</span>,<span style="color:#cd5555">&#34;city&#34;</span>]
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h4 id="term-Á≤æÁ¢∫ÂåπÈÖç">term Á≤æÁ¢∫ÂåπÈÖç</h4>
<ul>
<li>
<p>È°û‰ººmatchÂåπÈÖçÊüêÂÄãÂ±¨ÊÄßÔºå‰ΩÜÊòØterm<strong>‰∏çÂàÜË©û</strong>‰∏îÈ†àÂÆåÂÖ®Á¨¶Âêà</p>
<ul>
<li>‰æãÂ¶ÇÁî®termÊâæ&quot;Aviation Road&quot;ÔºåÂ∞±Âè™ÊúÉÊâæaddressÂÆåÂÖ®‰∏ÄËá¥ÁöÑÈÇ£ÂÄã&quot;Aviation Road&quot;ÔºåÂ§™Èï∑Â§™Áü≠ÊúâÊ≤íÊúâÁ©∫Ê†ºÈÄöÈÄöout</li>
</ul>
</li>
<li>
<p>Á∏Ω‰πãÊñáÂ≠óÊ™¢Á¥¢Áî®matchÔºåÂÖ∂‰ªñÈùûÊñáÂ≠óÂåπÈÖçÁî®term</p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2">GET</span> <span style="color:#a61717;background-color:#e3d2d2">bank/_search</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#8b008b;font-weight:bold">&#34;query&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">&#34;term&#34;</span>: {
</span></span><span style="display:flex;"><span>      <span style="color:#8b008b;font-weight:bold">&#34;address&#34;</span>: <span style="color:#cd5555">&#34;Aviation Road&#34;</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="Ë§áÂêàÊü•Ë©¢">Ë§áÂêàÊü•Ë©¢</h3>
<blockquote>
<p>ÂèØ‰ª•ÁµÑÂêàÂµåÂ•ó‰ΩøÁî®ÔºåËÆìÊü•Ë©¢Ê¢ù‰ª∂ÂçÉËÆäËê¨Âåñ</p>
</blockquote>
<h4 id="bool-Ê¢ù‰ª∂Âà§Êñ∑">bool Ê¢ù‰ª∂Âà§Êñ∑</h4>
<ul>
<li>
<p><code>must</code> ÂøÖÈ†àÈÅîÂà∞mustÊâÄÂàóËàâÁöÑÊâÄÊúâÊ¢ù‰ª∂</p>
<ul>
<li>Â∞±ÊòØand</li>
</ul>
</li>
<li>
<p><code>must_not</code> ÂøÖÈ†à‰∏çÂåπÈÖç<code>must_not</code>ÊâÄÂàóËàâÁöÑÊâÄÊúâÊ¢ù‰ª∂</p>
<ul>
<li>Â∞±ÊòØnot</li>
</ul>
</li>
<li>
<p><code>should</code> ÊáâË©≤ÊªøË∂≥shouldÊâÄÂàóËàâÁöÑÊ¢ù‰ª∂</p>
<ul>
<li>Â∞±ÊòØÂä†ÂàÜÈ†ÖÔºåÊúâÊõ¥Â•ΩÔºåÊ≤íÊúâ‰πüË°å</li>
</ul>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2">GET</span> <span style="color:#a61717;background-color:#e3d2d2">bank/_search</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>   <span style="color:#8b008b;font-weight:bold">&#34;query&#34;</span>:{
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">&#34;bool&#34;</span>:{
</span></span><span style="display:flex;"><span>             <span style="color:#8b008b;font-weight:bold">&#34;must&#34;</span>:[
</span></span><span style="display:flex;"><span>              {<span style="color:#8b008b;font-weight:bold">&#34;match&#34;</span>:{<span style="color:#8b008b;font-weight:bold">&#34;address&#34;</span>:<span style="color:#cd5555">&#34;mill&#34;</span>}},
</span></span><span style="display:flex;"><span>              {<span style="color:#8b008b;font-weight:bold">&#34;match&#34;</span>:{<span style="color:#8b008b;font-weight:bold">&#34;gender&#34;</span>:<span style="color:#cd5555">&#34;M&#34;</span>}}
</span></span><span style="display:flex;"><span>             ]
</span></span><span style="display:flex;"><span>         }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ul>
<li>Âú®booleanÊü•Ë©¢‰∏≠Ôºå<code>must</code>, <code>should</code> Âíå<code>must_not</code> ÂÖÉÁ¥†ÈÉΩË¢´Á®±ÁÇ∫Êü•Ë©¢Â≠êÂè•</li>
<li>ÊñáÊ™îÊòØÂê¶Á¨¶ÂêàÊØèÂÄãÂ≠êÂè•‰∏≠ÁöÑÊ®ôÊ∫ñÔºåÊ±∫ÂÆö‰∫ÜÊñáÊ™îÁöÑ&quot;<strong>Áõ∏ÈóúÊÄßÂæóÂàÜ</strong>&quot;</li>
</ul>
<h4 id="filter-ÁµêÊûúÈÅéÊøæ">filter ÁµêÊûúÈÅéÊøæ</h4>
<ul>
<li>‰∏çÊúÉË®àÁÆóÁõ∏ÈóúÊÄßÂæóÂàÜÔºåÁ¥îÈÅéÊøæ
<ul>
<li>Áî®Âú®‰∏çÊÉ≥Â∞çË©ïÂàÜÊéíÂ∫èÊúâÂΩ±ÈüøÁöÑÂ†¥ÂêàÔºåÈ°û‰ººbetween‰πãÈ°û</li>
</ul>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2">GET</span> <span style="color:#a61717;background-color:#e3d2d2">bank/_search</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#8b008b;font-weight:bold">&#34;query&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">&#34;bool&#34;</span>: {
</span></span><span style="display:flex;"><span>      <span style="color:#8b008b;font-weight:bold">&#34;must&#34;</span>: [
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>          <span style="color:#8b008b;font-weight:bold">&#34;match&#34;</span>: {
</span></span><span style="display:flex;"><span>            <span style="color:#8b008b;font-weight:bold">&#34;address&#34;</span>: <span style="color:#cd5555">&#34;mill&#34;</span>
</span></span><span style="display:flex;"><span>          }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>      ],
</span></span><span style="display:flex;"><span>      <span style="color:#8b008b;font-weight:bold">&#34;filter&#34;</span>: {
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">&#34;range&#34;</span>: {
</span></span><span style="display:flex;"><span>          <span style="color:#8b008b;font-weight:bold">&#34;balance&#34;</span>: {
</span></span><span style="display:flex;"><span>            <span style="color:#8b008b;font-weight:bold">&#34;gte&#34;</span>: <span style="color:#cd5555">&#34;10000&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#8b008b;font-weight:bold">&#34;lte&#34;</span>: <span style="color:#cd5555">&#34;20000&#34;</span>
</span></span><span style="display:flex;"><span>          }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="aggregation-Âü∑Ë°åËÅöÂêà">aggregation Âü∑Ë°åËÅöÂêà</h3>
<ul>
<li>È°û‰ººGROUP BYÁöÑÊ¶ÇÂøµÔºåÂèØ‰ª•Â∞áÊü•Ë©¢ÁöÑÁµêÊûú‰æùÁÖßÊ¢ù‰ª∂ÂàÜÁµÑÊâìÂåÖÊàê<code>buckets</code></li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2">GET</span> <span style="color:#a61717;background-color:#e3d2d2">bank/_search</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">&#34;aggs&#34;</span>: {
</span></span><span style="display:flex;"><span>  <span style="color:#8b008b;font-weight:bold">&#34;NAME&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">&#34;AGG_TYPE&#34;</span>: {}
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ul>
<li><code>NAME</code> ÈÄôÊ¨°ËÅöÂêàÁöÑÂêçÂ≠óÔºåÂ∞±ÂÉèMySQLÂèñÂà•Âêç</li>
<li><code>AGG_TYPE</code> ËÅöÂêàÁöÑÈ°ûÂûã
<ul>
<li><code>avg</code> Âπ≥Âùá</li>
<li><code>term</code> Á≤æÁ¢∫ÂåπÈÖç</li>
<li><code>terms</code> Â§öÂÄãÁ≤æÁ¢∫ÂåπÈÖç</li>
</ul>
</li>
</ul>
<p><img src="image-20220119152725760.png" alt="image-20220119152725760"></p>
<h4 id="Â≠êËÅöÂêà">Â≠êËÅöÂêà</h4>
<ul>
<li>Âü∫ÊñºÊüêÂÄãËÅöÂêàÁµêÊûú‰æÜËÅöÂêàÔºåÂØ´Âú®Áà∂ËÅöÂêà‰πãÂÖß
<ul>
<li><code>&quot;size&quot;: 0</code> ‰∏çÊÉ≥ÈóúÊ≥®ÊØèÂÄã‰∫∫ÁöÑË©≥ÊÉÖÔºåÂè™ÊÉ≥Ë¶ÅÁµ±Ë®àÁµêÊûú</li>
</ul>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2">GET</span> <span style="color:#a61717;background-color:#e3d2d2">bank/_search</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#8b008b;font-weight:bold">&#34;query&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">&#34;match_all&#34;</span>: {}
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  <span style="color:#8b008b;font-weight:bold">&#34;aggs&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">&#34;Âπ¥ÈΩ°ÂàÜÁµÑ&#34;</span>: {
</span></span><span style="display:flex;"><span>      <span style="color:#8b008b;font-weight:bold">&#34;terms&#34;</span>: {
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">&#34;field&#34;</span>: <span style="color:#cd5555">&#34;age&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">&#34;size&#34;</span>: <span style="color:#b452cd">10</span>
</span></span><span style="display:flex;"><span>      },
</span></span><span style="display:flex;"><span>      <span style="color:#8b008b;font-weight:bold">&#34;aggs&#34;</span>: {
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">&#34;Âπ≥ÂùáËñ™Ë≥á&#34;</span>: {
</span></span><span style="display:flex;"><span>          <span style="color:#8b008b;font-weight:bold">&#34;avg&#34;</span>: {
</span></span><span style="display:flex;"><span>            <span style="color:#8b008b;font-weight:bold">&#34;field&#34;</span>: <span style="color:#cd5555">&#34;balance&#34;</span>
</span></span><span style="display:flex;"><span>          }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  <span style="color:#8b008b;font-weight:bold">&#34;size&#34;</span>: <span style="color:#b452cd">0</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><img src="image-20220119154011303.png" alt="image-20220119154011303"></p>
<ul>
<li>ÁØÑ‰æã2: Êü•Âá∫ÊâÄÊúâÂπ¥ÈΩ°ÂàÜ‰ΩàÔºå‰∏¶‰∏îÈÄô‰∫õÂπ¥ÈΩ°ÊÆµ‰∏≠MÁöÑÂπ≥ÂùáËñ™Ë≥áÂíåFÁöÑÂπ≥ÂùáËñ™Ë≥á‰ª•ÂèäÈÄôÂÄãÂπ¥ÈΩ°ÊÆµÁöÑÁ∏ΩÈ´îÂπ≥ÂùáËñ™Ë≥á
<ul>
<li><code>.keyword</code> Á≤æÁ¢∫ÂåπÈÖç</li>
</ul>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2">GET</span> <span style="color:#a61717;background-color:#e3d2d2">bank/_search</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#8b008b;font-weight:bold">&#34;query&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">&#34;match_all&#34;</span>: {}
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  <span style="color:#8b008b;font-weight:bold">&#34;aggs&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">&#34;ageAgg&#34;</span>: {
</span></span><span style="display:flex;"><span>      <span style="color:#8b008b;font-weight:bold">&#34;terms&#34;</span>: {
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">&#34;field&#34;</span>: <span style="color:#cd5555">&#34;age&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">&#34;size&#34;</span>: <span style="color:#b452cd">100</span>
</span></span><span style="display:flex;"><span>      },
</span></span><span style="display:flex;"><span>      <span style="color:#8b008b;font-weight:bold">&#34;aggs&#34;</span>: {
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">&#34;genderAgg&#34;</span>: {
</span></span><span style="display:flex;"><span>          <span style="color:#8b008b;font-weight:bold">&#34;terms&#34;</span>: {
</span></span><span style="display:flex;"><span>            <span style="color:#8b008b;font-weight:bold">&#34;field&#34;</span>: <span style="color:#cd5555">&#34;gender.keyword&#34;</span>
</span></span><span style="display:flex;"><span>          },
</span></span><span style="display:flex;"><span>          <span style="color:#8b008b;font-weight:bold">&#34;aggs&#34;</span>: {
</span></span><span style="display:flex;"><span>            <span style="color:#8b008b;font-weight:bold">&#34;balanceAvg&#34;</span>: {
</span></span><span style="display:flex;"><span>              <span style="color:#8b008b;font-weight:bold">&#34;avg&#34;</span>: {
</span></span><span style="display:flex;"><span>                <span style="color:#8b008b;font-weight:bold">&#34;field&#34;</span>: <span style="color:#cd5555">&#34;balance&#34;</span>
</span></span><span style="display:flex;"><span>              }
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>          }
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">&#34;ageBalanceAvg&#34;</span>: {
</span></span><span style="display:flex;"><span>          <span style="color:#8b008b;font-weight:bold">&#34;avg&#34;</span>: {
</span></span><span style="display:flex;"><span>            <span style="color:#8b008b;font-weight:bold">&#34;field&#34;</span>: <span style="color:#cd5555">&#34;balance&#34;</span>
</span></span><span style="display:flex;"><span>          }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  <span style="color:#8b008b;font-weight:bold">&#34;size&#34;</span>: <span style="color:#b452cd">0</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><img src="image-20220119154724229.png" alt="image-20220119154724229"></p>
<hr>
<h2 id="mapping">Mapping</h2>
<blockquote>
<p>Â∞±ÊòØÂª∫Ë°®ÊôÇÊåáÂÆöÂ≠òÂú®Ë£°Èù¢ÁöÑÁé©ÊÑèÁöÑË¶èÂâá</p>
</blockquote>
<ul>
<li>
<p>MapingÊòØÁî®‰æÜÂÆöÁæ©‰∏ÄÂÄãÊñáÊ™îÔºàdocumentÔºâÔºå‰ª•ÂèäÂÆÉÊâÄÂåÖÂê´ÁöÑÂ±¨ÊÄßÔºàfieldÔºâÊòØÂ¶Ç‰ΩïÂ≠òÂÑ≤ÂíåÁ¥¢ÂºïÁöÑ„ÄÇÊØîÂ¶Ç:</p>
<ul>
<li>
<p>Êï∏ÂÄºÊ†ºÂºè: ÈÉΩÊòØjson‰ΩÜ‰πüËÉΩÂàÜtext„ÄÅlong</p>
</li>
<li>
<p>Âì™‰∫õÂ≠óÁ¨¶‰∏≤Â±¨ÊÄßÊáâË©≤Ë¢´ÁúãÂÅöÂÖ®ÊñáÊú¨Â±¨ÊÄßÔºàfull text fieldsÔºâ</p>
</li>
<li>
<p>Âì™‰∫õÂ±¨ÊÄßÂåÖÂê´Êï∏Â≠óÔºåÊó•ÊúüÊàñÂú∞ÁêÜ‰ΩçÁΩÆ</p>
</li>
<li>
<p>ÊñáÊ™î‰∏≠ÁöÑÊâÄÊúâÂ±¨ÊÄßÊòØÂê¶ÈÉΩË¢´Á¥¢Âºï(Â∞±ÊòØÊ±∫ÂÆöÊòØÂê¶ÊúÉË¢´ÊêúÔºåÈ†êË®≠ÈÉΩÊòØtrue)</p>
</li>
<li>
<p>Êó•ÊúüÁöÑÊ†ºÂºè</p>
</li>
<li>
<p>Ëá™ÂÆöÁæ©Êò†Â∞ÑË¶èÂâá‰æÜÂü∑Ë°åÂãïÊÖãÊ∑ªÂä†Â±¨ÊÄß</p>
</li>
</ul>
</li>
<li>
<p>Êü•Áúãmapping‰ø°ÊÅØ <code>GET bank/_mapping</code></p>
</li>
</ul>
<h3 id="ÊåáÂÆömapping">ÊåáÂÆömapping</h3>
<ul>
<li>Ë¶ÅÂú®Âª∫Á´ãindexÁöÑÊôÇÂÄôÂ∞±ÊåáÂÆöÔºå‰∏çÁÑ∂Â∞±ÊòØÈ†êË®≠ÁöÑ
<ul>
<li>È°û‰ººSQLÂª∫Ë°®ÁöÑÊôÇÂÄôÊåáÂÆöË°®ÁöÑÊßãÊàê</li>
</ul>
</li>
</ul>
<pre tabindex="0"><code>PUT /my_index
{
  &#34;mappings&#34;: {
    &#34;properties&#34;: {
      &#34;age&#34;: {
        &#34;type&#34;: &#34;integer&#34;
      },
      &#34;email&#34;: {
        &#34;type&#34;: &#34;keyword&#34;
      },
      &#34;name&#34;: {
        &#34;type&#34;: &#34;text&#34;
      }
    }
  }
}
</code></pre><ul>
<li>MappingÂª∫ÂÆåÂ∞±‰∏çËÉΩÊîπÔºåË¶ÅÊîπÂè™ËÉΩÂÉèÁµ¶databaseÊîπÂêçÔºåË§áË£ΩÂª∫Êñ∞ÁöÑÈÇ£Ê®£</li>
</ul>
<h2 id="ÂàÜË©û">ÂàÜË©û</h2>
<ul>
<li>È°ßÂêçÊÄùÁæ©Â∞áË©ûÊãÜÈñãÊàêÊúâÊÑèÁæ©ÁöÑÁâáÊÆµÔºåÈ†êË®≠Â∞±ÊòØÁî®standardÊ®ôÊ∫ñÂàÜË©ûÂô®Ôºå‰æãÂ¶Ç:</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2">POST</span> <span style="color:#a61717;background-color:#e3d2d2">_analyze</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#8b008b;font-weight:bold">&#34;analyzer&#34;</span>: <span style="color:#cd5555">&#34;standard&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#8b008b;font-weight:bold">&#34;text&#34;</span>: <span style="color:#cd5555">&#34;The 2 QUICK Brown-Foxes jumped over the lazy dog&#39;s bone.&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ul>
<li>tokenizerÂàÜË©ûÂô®ÔºåÂ∞áË©ûÊãÜÊàê‰∏ÄÂÄã‰∏ÄÂÄãÁöÑ<code>token</code></li>
<li>È†êË®≠ÁöÑ‰∏≠ÊñáÂàÜ‰∏çÂ•Ω(ÊáâË©≤Ë™™Âè™ÊúÉÂÖ®ÈÉ®ÊãÜÊàê‰∏ÄÂÄãÂ≠ó)ÔºåÈúÄË¶ÅÁÅ´ÂäõÊîØÊè¥</li>
</ul>
<h3 id="ÂÆâË£ùikÂàÜË©ûÂô®">ÂÆâË£ùikÂàÜË©ûÂô®</h3>
<ul>
<li>
<p><a href="https://github.com/medcl/elasticsearch-analysis-ik">https://github.com/medcl/elasticsearch-analysis-ik</a></p>
<ul>
<li>ÈúÄË¶ÅÂ∞çÊáâÁâàÊú¨</li>
</ul>
</li>
<li>
<p>‰ΩøÁî®Êèí‰ª∂ÂÆâË£ùÔºåË∂ÖÁ∞°ÂñÆÔºåÈÄ≤Âà∞ÂÆπÂô®ÂÖß‰ΩøÁî®ÂëΩ‰ª§</p>
</li>
</ul>
<pre tabindex="0"><code>./bin/elasticsearch-plugin install xxxÊèí‰ª∂ÁâàÊú¨Ë≥áÊ∫êÁ∂≤ÂùÄ
</code></pre><ul>
<li>Áõ¥Êé•Âæûdocker desktopÊâìÈñãË©≤ÂÆπÂô®ÁöÑCLI</li>
<li>Âõ†ÁÇ∫ÊòØ2Âêà‰∏ÄÈè°ÂÉèÔºåÈÄ≤‰∫ÜÂÆπÂô®ÈÇÑË¶Å<code>cd elasticsearch-7.16.2</code>ÂÜçÈÄ≤Âà∞elasticsearchË≥áÊñôÂ§æ‰∏ãÔºåÂü∑Ë°å:</li>
</ul>
<pre tabindex="0"><code>./bin/elasticsearch-plugin install https://github.com/medcl/elasticsearch-analysis-ik/releases/download/v7.16.2/elasticsearch-analysis-ik-7.16.2.zip
</code></pre><p><img src="image-20220119161207797.png" alt="image-20220119161207797"></p>
<ul>
<li>Âè¶Â§ñÈôÑ‰∏äÊïôÂ≠∏ÁöÑÊâãÂãïÊñπÊ≥ïÔºåÂú®ÂâçÈù¢ÊàëÂÄëÂ∑≤Á∂ìÂ∞áelasticsearchÂÆπÂô®ÁöÑ‚Äú/usr/share/elasticsearch/plugins‚ÄùÁõÆÈåÑÔºåÊò†Â∞ÑÂà∞ÂÆø‰∏ªÊ©üÁöÑ‚Äú /mydata/elasticsearch/plugins‚ÄùÁõÆÈåÑ‰∏ãÔºåÊâÄ‰ª•ÊØîËºÉÊñπ‰æøÁöÑÂÅöÊ≥ïÂ∞±ÊòØ‰∏ãËºâ‚Äú/elasticsearch-analysis-ik-xxx.zip‚ÄùÊñá‰ª∂ÔºåÁÑ∂ÂæåËß£Â£ìÂà∞Ë©≤Êñá‰ª∂Â§æ‰∏ãÂç≥ÂèØ</li>
</ul>
<pre tabindex="0"><code>// ÈÄ≤ÂÖ•esÂÆπÂô®ÂÖßÈÉ®pluginÁõÆÈåÑ
docker exec -it elasticsearch /bin/bash

// ‰∏ãËºâ
# wget https://github.com/medcl/elasticsearch-analysis-ik/releases/download/v7.6.2/elasticsearch-analysis-ik-7.6.2.zip

// Ëß£Â£ìÁ∏Æ
unzip elasticsearch-analysis-ik-7.6.2.zip -d ink

// Êê¨Âà∞Êèí‰ª∂Ë≥áÊñôÂ§æ
mv ik plugins/

// Âà™Èô§ÊÆòÈ§ò
rm -rf elasticsearch-analysis-ik-7.6.2.zip
</code></pre><ul>
<li>ÊîπÂÆåÈÉΩË¶ÅÈáçÂïüÂÆπÂô®ÊâçËÉΩÁîüÊïà!</li>
<li>Ê∏¨Ë©¶:</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2">POST</span> <span style="color:#a61717;background-color:#e3d2d2">_analyze</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#8b008b;font-weight:bold">&#34;analyzer&#34;</span>: <span style="color:#cd5555">&#34;ik_max_word&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#8b008b;font-weight:bold">&#34;text&#34;</span>: <span style="color:#cd5555">&#34;„ÄäÁôΩÈõ™ÂÖ¨‰∏ª„ÄãÊòØÂª£Ê≥õÊµÅË°åÊñºÊ≠êÊ¥≤ÁöÑ‰∏ÄÁØáÂæ∑ÂúãÁ´•Ë©±Ôºå‰∫¶ÊòØË©≤Á´•Ë©±‰∏≠ÁöÑ‰∏ªËßí„ÄÇÂÖ∂ÊúÄËëóÂêçÁöÑÁâàÊú¨Ë¶ãÊñºÂæ∑Âúã„ÄäÊ†ºÊûóÁ´•Ë©±„ÄãÔºåË¨õËø∞‰∫ÜÁôΩÈõ™ÂÖ¨‰∏ªÂèóÂà∞ÁπºÊØçÁöÑËôêÂæÖÔºåÈÄÉÂà∞Ê£ÆÊûóË£°ÔºåÈÅáÂà∞‰∏ÉÂÄãÂ∞èÁüÆ‰∫∫ÁöÑÊïÖ‰∫ã&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><img src="image-20220119161834409.png" alt="image-20220119161834409"></p>
<h3 id="Ëá™ÂÆöÁæ©Ë©ûÂ∫´">Ëá™ÂÆöÁæ©Ë©ûÂ∫´</h3>
<ul>
<li>‰øÆÊîπ<code>/usr/share/elasticsearch/plugins/ik/config</code>‰∏≠ÁöÑ<code>IKAnalyzer.cfg.xml</code></li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#1e889b">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#1e889b">&lt;!DOCTYPE properties SYSTEM &#34;http://java.sun.com/dtd/properties.dtd&#34;&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">&lt;properties&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#8b008b;font-weight:bold">&lt;comment&gt;</span>IK Analyzer Êì¥Â±ïÈÖçÁΩÆ<span style="color:#8b008b;font-weight:bold">&lt;/comment&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#228b22">&lt;!--Áî®Êà∑ÂèØ‰ª•Âú®ÈÄôË£èÈÖçÁΩÆËá™Â∑±ÁöÑÊì¥Â±ïÂ≠óÂÖ∏ --&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#8b008b;font-weight:bold">&lt;entry</span> <span style="color:#658b00">key=</span><span style="color:#cd5555">&#34;ext_dict&#34;</span><span style="color:#8b008b;font-weight:bold">&gt;&lt;/entry&gt;</span>
</span></span><span style="display:flex;"><span>	 <span style="color:#228b22">&lt;!--Áî®Êà∑ÂèØ‰ª•Âú®ÈÄôË£èÈÖçÁΩÆËá™Â∑±ÁöÑÊì¥Â±ïÂÅúÊ≠¢Ë©ûÂ≠óÂÖ∏--&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#8b008b;font-weight:bold">&lt;entry</span> <span style="color:#658b00">key=</span><span style="color:#cd5555">&#34;ext_stopwords&#34;</span><span style="color:#8b008b;font-weight:bold">&gt;&lt;/entry&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#228b22">&lt;!--Áî®Êà∑ÂèØ‰ª•Âú®ÈÄôË£èÈÖçÁΩÆÈÅ†Á®ãÊì¥Â±ïÂ≠óÂÖ∏ --&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#228b22">&lt;!-- &lt;entry key=&#34;remote_ext_dict&#34;&gt;words_location&lt;/entry&gt; --&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#228b22">&lt;!--Áî®Êà∑ÂèØ‰ª•Âú®ÈÄôË£èÈÖçÁΩÆÈÅ†Á®ãÊì¥Â±ïÂÅúÊ≠¢Ë©ûÂ≠óÂÖ∏--&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#228b22">&lt;!-- &lt;entry key=&#34;remote_ext_stopwords&#34;&gt;words_location&lt;/entry&gt; --&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">&lt;/properties&gt;</span>
</span></span></code></pre></div><ul>
<li>Êõ¥Êñ∞ÂÆåÊàêÂæåÔºåesÂè™ÊúÉÂ∞çÊñºÊñ∞Â¢ûÁöÑÊï∏ÊìöÁî®Êõ¥Êñ∞ÂàÜË©û„ÄÇÊ≠∑Âè≤Êï∏ÊìöÊòØ‰∏çÊúÉÈáçÊñ∞ÂàÜË©ûÁöÑ„ÄÇÂ¶ÇÊûúÊÉ≥Ë¶ÅÊ≠∑Âè≤Êï∏ÊìöÈáçÊñ∞ÂàÜË©ûÔºåÈúÄË¶ÅÂü∑Ë°å:</li>
</ul>
<pre tabindex="0"><code>POST my_index/_update_by_query?conflicts=proceed
</code></pre><ul>
<li>ÊàëÁî®ÁöÑ‰∫åÂêà‰∏ÄÈè°ÂÉèÊòØÂú®</li>
</ul>
<pre tabindex="0"><code>/home/elasticsearch/elasticsearch-7.16.2/config/analysis-ik/IKAnalyzer.cfg.xml
</code></pre><ul>
<li>Â∞áÊ™îÊ°àÊäìÂá∫‰æÜÊîæÂà∞linuxÂÆø‰∏ª<code>/mydata/elasticsearch</code>Ë∑ØÂæë‰∏ã</li>
</ul>
<pre tabindex="0"><code>docker cp elasticsearch:/home/elasticsearch/elasticsearch-7.16.2/config/analysis-ik/IKAnalyzer.cfg.xml /mydata/elasticsearch
</code></pre><ul>
<li>Êîπ‰∏ÄÊîπÔºåÂ°ûÂõûÂéª</li>
</ul>
<hr>
<h1 id="Êï¥Âêàspring">Êï¥ÂêàSpring</h1>
<ul>
<li>Â∞é‰æùË≥¥ÔºåÊ≥®ÊÑèÁâàÊú¨Ë¶ÅÁ≠âÂêåELKÁöÑÁâàÊú¨</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">&lt;dependency&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">&lt;groupId&gt;</span>org.elasticsearch.client<span style="color:#8b008b;font-weight:bold">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">&lt;artifactId&gt;</span>elasticsearch-rest-high-level-client<span style="color:#8b008b;font-weight:bold">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">&lt;version&gt;</span>7.16.2<span style="color:#8b008b;font-weight:bold">&lt;/version&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">&lt;/dependency&gt;</span>
</span></span></code></pre></div><ul>
<li>‰∏¶‰∏îË¶ÅÂú®È†ÖÁõÆ‰∏≠ÊåáÂÆöproperties</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">&lt;properties&gt;</span>
</span></span><span style="display:flex;"><span>        ...
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">&lt;elasticsearch.version&gt;</span>7.16.2<span style="color:#8b008b;font-weight:bold">&lt;/elasticsearch.version&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">&lt;/properties&gt;</span>
</span></span></code></pre></div><h2 id="Ê∏¨Ë©¶ÈÄ£Á∑ö">Ê∏¨Ë©¶ÈÄ£Á∑ö</h2>
<ul>
<li>ÂÖàÈÄ†‰∏ÄÂÄãË®≠ÂÆöÈ°û</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#707a7c">@Configuration</span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">class</span> <span style="color:#008b45;font-weight:bold">ElasticConfig</span> {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">// Ë®≠ÂÆö
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>    <span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">static</span> <span style="color:#8b008b;font-weight:bold">final</span> RequestOptions COMMON_OPTIONS;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">static</span> {
</span></span><span style="display:flex;"><span>        RequestOptions.<span style="color:#658b00">Builder</span> builder = RequestOptions.<span style="color:#658b00">DEFAULT</span>.<span style="color:#658b00">toBuilder</span>();
</span></span><span style="display:flex;"><span>        <span style="color:#228b22">// builder.addHeader(&#34;Authorization&#34;, &#34;Bearer &#34; + TOKEN);
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>        <span style="color:#228b22">// builder.setHttpAsyncResponseConsumerFactory(
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>        <span style="color:#228b22">//         new HttpAsyncResponseConsumerFactory
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>        <span style="color:#228b22">//                 .HeapBufferedResponseConsumerFactory(30 * 1024 * 1024 * 1024));
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>        COMMON_OPTIONS = builder.<span style="color:#658b00">build</span>();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">// Â∑≤Á∂ìË¢´Ê£ÑÁî®ÁöÑÂâµÈÄ†ClientÊñπÊ≥ï
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>    <span style="color:#707a7c">@Bean</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> RestHighLevelClient <span style="color:#008b45">restHighLevelClient</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#228b22">// Create the low-level client
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>        RestClientBuilder httpClientBuilder = RestClient.<span style="color:#658b00">builder</span>(
</span></span><span style="display:flex;"><span>                <span style="color:#8b008b;font-weight:bold">new</span> HttpHost(<span style="color:#cd5555">&#34;localhost&#34;</span>, 9200)
</span></span><span style="display:flex;"><span>        );
</span></span><span style="display:flex;"><span>        <span style="color:#228b22">// Create the HLRC
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>        RestHighLevelClient hlrc = <span style="color:#8b008b;font-weight:bold">new</span> RestHighLevelClient(httpClientBuilder);
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">return</span> hlrc;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ul>
<li>Á∞°ÂñÆÊ∏¨Ë©¶ÔºåÂòóË©¶ÈÄ†‰∏ÄÂÄãindexËàáÁâ©‰ª∂</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#707a7c">@SpringBootTest</span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">class</span> <span style="color:#008b45;font-weight:bold">EsTest</span> {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#707a7c">@Autowired</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">private</span> RestHighLevelClient client;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#707a7c">@Data</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">class</span> <span style="color:#008b45;font-weight:bold">User</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">private</span> String name;
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">private</span> <span style="color:#00688b;font-weight:bold">int</span> age;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#707a7c">@Test</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">test</span>() <span style="color:#8b008b;font-weight:bold">throws</span> IOException {
</span></span><span style="display:flex;"><span>        <span style="color:#228b22">// Âª∫Á´ã‰∏ÄÂÄãÊ∏¨Ë©¶ÁöÑÁâ©‰ª∂
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>        User user = <span style="color:#8b008b;font-weight:bold">new</span> User();
</span></span><span style="display:flex;"><span>        user.<span style="color:#658b00">setName</span>(<span style="color:#cd5555">&#34;Tom&#34;</span>);
</span></span><span style="display:flex;"><span>        user.<span style="color:#658b00">setAge</span>(30);
</span></span><span style="display:flex;"><span>        String s = JSONUtil.<span style="color:#658b00">toJsonStr</span>(user);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#228b22">// ÂâµÁ´ãindex
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>        IndexRequest indexRequest = <span style="color:#8b008b;font-weight:bold">new</span> IndexRequest(<span style="color:#cd5555">&#34;users&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#228b22">// ÊåáÂÆöid
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>        indexRequest.<span style="color:#658b00">id</span>(<span style="color:#cd5555">&#34;1&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#228b22">// ÊîæÈÄ≤ÂéªÁöÑÊù±Ë•øÔºåÂ¶ÇÊûúÊòØÂ≠ó‰∏≤ÂøÖÈ†àËÅ≤ÊòéÊòØXContentType.JSONÔºåÂê¶ÂâáË¶ÅÊîæmap
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>        indexRequest.<span style="color:#658b00">source</span>(s, XContentType.<span style="color:#658b00">JSON</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#228b22">// Âü∑Ë°åÔºåÁ¨¨2ÂÄãÂèÉÊï∏ÊòØ‰ΩøÁî®‰∏ÄËà¨Ë®≠ÂÆö
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>        IndexResponse response = client.<span style="color:#658b00">index</span>(indexRequest, ElasticConfig.<span style="color:#658b00">COMMON_OPTIONS</span>);
</span></span><span style="display:flex;"><span>        System.<span style="color:#658b00">out</span>.<span style="color:#658b00">println</span>(<span style="color:#cd5555">&#34;response = &#34;</span> + response);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ul>
<li>Ê∏¨Ë©¶2</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>    <span style="color:#707a7c">@Test</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">searchData</span>() <span style="color:#8b008b;font-weight:bold">throws</span> IOException {
</span></span><span style="display:flex;"><span>        GetRequest getRequest = <span style="color:#8b008b;font-weight:bold">new</span> GetRequest(
</span></span><span style="display:flex;"><span>                <span style="color:#cd5555">&#34;users&#34;</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#cd5555">&#34;_-2vAHIB0nzmLJLkxKWk&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        GetResponse getResponse = client.<span style="color:#658b00">get</span>(getRequest, RequestOptions.<span style="color:#658b00">DEFAULT</span>);
</span></span><span style="display:flex;"><span>        System.<span style="color:#658b00">out</span>.<span style="color:#658b00">println</span>(getResponse);
</span></span><span style="display:flex;"><span>        String index = getResponse.<span style="color:#658b00">getIndex</span>();
</span></span><span style="display:flex;"><span>        System.<span style="color:#658b00">out</span>.<span style="color:#658b00">println</span>(index);
</span></span><span style="display:flex;"><span>        String id = getResponse.<span style="color:#658b00">getId</span>();
</span></span><span style="display:flex;"><span>        System.<span style="color:#658b00">out</span>.<span style="color:#658b00">println</span>(id);
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">if</span> (getResponse.<span style="color:#658b00">isExists</span>()) {
</span></span><span style="display:flex;"><span>            <span style="color:#00688b;font-weight:bold">long</span> version = getResponse.<span style="color:#658b00">getVersion</span>();
</span></span><span style="display:flex;"><span>            System.<span style="color:#658b00">out</span>.<span style="color:#658b00">println</span>(version);
</span></span><span style="display:flex;"><span>            String sourceAsString = getResponse.<span style="color:#658b00">getSourceAsString</span>();
</span></span><span style="display:flex;"><span>            System.<span style="color:#658b00">out</span>.<span style="color:#658b00">println</span>(sourceAsString);
</span></span><span style="display:flex;"><span>            Map&lt;String, Object&gt; sourceAsMap = getResponse.<span style="color:#658b00">getSourceAsMap</span>();
</span></span><span style="display:flex;"><span>            System.<span style="color:#658b00">out</span>.<span style="color:#658b00">println</span>(sourceAsMap);
</span></span><span style="display:flex;"><span>            <span style="color:#00688b;font-weight:bold">byte</span>[] sourceAsBytes = getResponse.<span style="color:#658b00">getSourceAsBytes</span>();
</span></span><span style="display:flex;"><span>        } <span style="color:#8b008b;font-weight:bold">else</span> {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span></code></pre></div><h2 id="Ê™¢Á¥¢ÁØÑ‰æã">Ê™¢Á¥¢ÁØÑ‰æã</h2>
<blockquote>
<p>DSLÊúâÁöÑÈÄôÈÇäÈÉΩÊúâÔºåÁøªËëóÂÆòÊñπÊñáÊ™îÂØ´Âêß</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#228b22">/**
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * Ë§áÈõúÊ™¢Á¥¢:Âú®bank‰∏≠ÊêúÁ¥¢address‰∏≠ÂåÖÂê´millÁöÑÊâÄÊúâ‰∫∫ÁöÑÂπ¥ÈΩ°ÂàÜ‰Ωà‰ª•ÂèäÂπ≥ÂùáÂπ¥ÈΩ°ÔºåÂπ≥ÂùáËñ™Ë≥á
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     * @throws IOException
</span></span></span><span style="display:flex;"><span><span style="color:#228b22">     */</span>
</span></span><span style="display:flex;"><span><span style="color:#707a7c">@Test</span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">searchData</span>() <span style="color:#8b008b;font-weight:bold">throws</span> IOException {
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">//1. ÂâµÂª∫Ê™¢Á¥¢Ë´ãÊ±Ç
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>    SearchRequest searchRequest = <span style="color:#8b008b;font-weight:bold">new</span> SearchRequest();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">//1.1ÔºâÊåáÂÆöÁ¥¢Âºï
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>    searchRequest.<span style="color:#658b00">indices</span>(<span style="color:#cd5555">&#34;bank&#34;</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">//1.2ÔºâÊßãÈÄ†Ê™¢Á¥¢Ê¢ù‰ª∂
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>    SearchSourceBuilder sourceBuilder = <span style="color:#8b008b;font-weight:bold">new</span> SearchSourceBuilder();
</span></span><span style="display:flex;"><span>    sourceBuilder.<span style="color:#658b00">query</span>(QueryBuilders.<span style="color:#658b00">matchQuery</span>(<span style="color:#cd5555">&#34;address&#34;</span>,<span style="color:#cd5555">&#34;Mill&#34;</span>));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">//1.2.1)ÊåâÁÖßÂπ¥ÈΩ°ÂàÜ‰ΩàÈÄ≤Ë°åËÅöÂêà
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>    TermsAggregationBuilder ageAgg=AggregationBuilders.<span style="color:#658b00">terms</span>(<span style="color:#cd5555">&#34;ageAgg&#34;</span>).<span style="color:#658b00">field</span>(<span style="color:#cd5555">&#34;age&#34;</span>).<span style="color:#658b00">size</span>(10);
</span></span><span style="display:flex;"><span>    sourceBuilder.<span style="color:#658b00">aggregation</span>(ageAgg);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">//1.2.2)Ë®àÁÆóÂπ≥ÂùáÂπ¥ÈΩ°
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>    AvgAggregationBuilder ageAvg = AggregationBuilders.<span style="color:#658b00">avg</span>(<span style="color:#cd5555">&#34;ageAvg&#34;</span>).<span style="color:#658b00">field</span>(<span style="color:#cd5555">&#34;age&#34;</span>);
</span></span><span style="display:flex;"><span>    sourceBuilder.<span style="color:#658b00">aggregation</span>(ageAvg);
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">//1.2.3)Ë®àÁÆóÂπ≥ÂùáËñ™Ë≥á
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>    AvgAggregationBuilder balanceAvg = AggregationBuilders.<span style="color:#658b00">avg</span>(<span style="color:#cd5555">&#34;balanceAvg&#34;</span>).<span style="color:#658b00">field</span>(<span style="color:#cd5555">&#34;balance&#34;</span>);
</span></span><span style="display:flex;"><span>    sourceBuilder.<span style="color:#658b00">aggregation</span>(balanceAvg);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    System.<span style="color:#658b00">out</span>.<span style="color:#658b00">println</span>(<span style="color:#cd5555">&#34;Ê™¢Á¥¢Ê¢ù‰ª∂Ôºö&#34;</span>+sourceBuilder);
</span></span><span style="display:flex;"><span>    searchRequest.<span style="color:#658b00">source</span>(sourceBuilder);
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">//2. Âü∑Ë°åÊ™¢Á¥¢
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>    SearchResponse searchResponse = client.<span style="color:#658b00">search</span>(searchRequest, RequestOptions.<span style="color:#658b00">DEFAULT</span>);
</span></span><span style="display:flex;"><span>    System.<span style="color:#658b00">out</span>.<span style="color:#658b00">println</span>(<span style="color:#cd5555">&#34;Ê™¢Á¥¢ÁµêÊûúÔºö&#34;</span>+searchResponse);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">//3. Â∞áÊ™¢Á¥¢ÁµêÊûúÂ∞ÅË£ùÁÇ∫Bean
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>    SearchHits hits = searchResponse.<span style="color:#658b00">getHits</span>();
</span></span><span style="display:flex;"><span>    SearchHit[] searchHits = hits.<span style="color:#658b00">getHits</span>();
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">for</span> (SearchHit searchHit : searchHits) {
</span></span><span style="display:flex;"><span>        String sourceAsString = searchHit.<span style="color:#658b00">getSourceAsString</span>();
</span></span><span style="display:flex;"><span>        Account account = JSON.<span style="color:#658b00">parseObject</span>(sourceAsString, Account.<span style="color:#658b00">class</span>);
</span></span><span style="display:flex;"><span>        System.<span style="color:#658b00">out</span>.<span style="color:#658b00">println</span>(account);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">//4. Áç≤ÂèñËÅöÂêà‰ø°ÊÅØ
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>    Aggregations aggregations = searchResponse.<span style="color:#658b00">getAggregations</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    Terms ageAgg1 = aggregations.<span style="color:#658b00">get</span>(<span style="color:#cd5555">&#34;ageAgg&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">for</span> (Terms.<span style="color:#658b00">Bucket</span> bucket : ageAgg1.<span style="color:#658b00">getBuckets</span>()) {
</span></span><span style="display:flex;"><span>        String keyAsString = bucket.<span style="color:#658b00">getKeyAsString</span>();
</span></span><span style="display:flex;"><span>        System.<span style="color:#658b00">out</span>.<span style="color:#658b00">println</span>(<span style="color:#cd5555">&#34;Âπ¥ÈΩ°Ôºö&#34;</span>+keyAsString+<span style="color:#cd5555">&#34; ==&gt; &#34;</span>+bucket.<span style="color:#658b00">getDocCount</span>());
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    Avg ageAvg1 = aggregations.<span style="color:#658b00">get</span>(<span style="color:#cd5555">&#34;ageAvg&#34;</span>);
</span></span><span style="display:flex;"><span>    System.<span style="color:#658b00">out</span>.<span style="color:#658b00">println</span>(<span style="color:#cd5555">&#34;Âπ≥ÂùáÂπ¥ÈΩ°Ôºö&#34;</span>+ageAvg1.<span style="color:#658b00">getValue</span>());
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    Avg balanceAvg1 = aggregations.<span style="color:#658b00">get</span>(<span style="color:#cd5555">&#34;balanceAvg&#34;</span>);
</span></span><span style="display:flex;"><span>    System.<span style="color:#658b00">out</span>.<span style="color:#658b00">println</span>(<span style="color:#cd5555">&#34;Âπ≥ÂùáËñ™Ë≥áÔºö&#34;</span>+balanceAvg1.<span style="color:#658b00">getValue</span>());
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ul>
<li>Ê≠•È©üÊï¥ÁêÜ:
<ul>
<li>ÊåáÂÆöindex</li>
<li>ÂâµÂª∫sourceBuilderÔºåË®≠ÂÆöÊü•Ë©¢Ê¢ù‰ª∂</li>
<li>Â∞ásourceÂ∞ÅË£ùÂà∞SearchRequest</li>
<li>Áî®clientÂ∞çES‰º∫ÊúçÁ´ØÁôºËµ∑SearchRequest</li>
<li>Êé•Êî∂Hits‰∏¶Ëß£Êûê</li>
</ul>
</li>
</ul>

                    
                    <HR width="100%" id="EOF">
		    <p style="color:#777;">‰∏äÊ¨°‰øÆÊîπÊñº 2022-01-25</p>
                    
                </div>
            </div>
            
            
            <nav class="post-pagination">

                
                <a class="newer-posts" href="https://yoziming.github.io/post/220125-wsl2-docker/">
			‰∏ã‰∏ÄÁØá<br>DockerDekstopÊéõËºâÁõ∏ÈóúË®≠ÂÆö
                </a>
                
                
                
                <a class="older-posts" href="https://yoziming.github.io/post/220124-gulimall-07/">
			‰∏ä‰∏ÄÁØá<br>ÂïÜÂìÅÂ±¨ÊÄßÁ∂≠Ë≠∑„ÄÅÂ∫´Â≠òÊ®°ÁµÑ„ÄÅÂü∫Á§éÁØáÁ∏ΩÁµê
                </a>
                
            </nav>
            <div class="post-comment-wrapper">
                








<div id="waline"></div>
<script>
    new Waline({
        el: '#waline',
        path: location.pathname,
        serverURL: "https://waline-pn38gfwbz-yoziming.vercel.app/" ,
		lang: 'en-US',
		visitor: true,
		meta: ['nick', 'mail'],
    });
    </script>



            </div>
        </div>
    </div>


                    </div>
            </div><div id="single-column-footer">
Hugo Theme <a href="https://github.com/amazingrise/hugo-theme-diary">Diary</a> by <a href="https://amazingrise.net">Rise</a>
<br>
ÁßªÊ§çËá™ <a href="https://mak1t0.cc/" target="_blank" rel="noreferrer noopener">Makito</a>'s <a href="https://github.com/SumiMakito/hexo-theme-journal/" target="_blank" rel="noreferrer noopener">Journal.</a> <br>
<br>

&copy;
	
	Yoziming
	
</div>
            </div>
    
    <script src="/js/journal.js"></script>
    </body>
</html>
