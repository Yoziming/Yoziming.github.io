<!DOCTYPE html>
<html><head>
<meta name="google-site-verification" content="XrwF-xUZWSGJVBBm7jM8vqemVqx--zo5Tb9d-Vr7BCc" />
<title>Ë®ªÂÜä„ÄÅÁôªÂÖ•ËàáSpring Session</title>




<meta charset="utf-8">
<meta name="X-UA-Compatible" content="IE=edge">
<meta name="google-site-verification" content="">
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
<meta content="telephone=no" name="format-detection">
<meta name="description" content="SpringBootÂæÆÊúçÂãôÈ†ÖÁõÆÁ≠ÜË®ò-16">
<meta name="renderer" content="webkit">
<meta name="theme-color" content="#ffffff">



<meta property="og:title" content="Ë®ªÂÜä„ÄÅÁôªÂÖ•ËàáSpring Session" />
<meta property="og:description" content="SpringBootÂæÆÊúçÂãôÈ†ÖÁõÆÁ≠ÜË®ò-16" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://yoziming.github.io/post/220202-gulimall-16-spring-session/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2022-02-02T00:00:00+00:00" />
<meta property="article:modified_time" content="2022-02-02T00:00:00+00:00" /><meta property="og:site_name" content="My Blog" />






<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Ë®ªÂÜä„ÄÅÁôªÂÖ•ËàáSpring Session"/>
<meta name="twitter:description" content="SpringBootÂæÆÊúçÂãôÈ†ÖÁõÆÁ≠ÜË®ò-16"/>







<link type="text/css" rel="stylesheet" href="/vendor/css/bootstrap.min.css">


  




<link rel="icon" href="https://yoziming.github.io/images/favicon.png">



<link rel="stylesheet" href="https://yoziming.github.io/scss/journal.min.3f72a5fc8f5b5dd732a4b476aced0eece2156958d9d414316494ddb10593ddf7.css" integrity="sha256-P3Kl/I9bXdcypLR2rO0O7OIVaVjZ1BQxZJTdsQWT3fc=" media="screen">



<link rel="stylesheet" href="https://yoziming.github.io/scss/dark-mode.min.f7c2efa7183435a6bd1842f91c541481c7a5137b5991629a870f24e4a516ad4b.css" integrity="sha256-98Lvpxg0Naa9GEL5HFQUgcelE3tZkWKahw8k5KUWrUs=" media="screen">


<script src="/vendor/js/loadCSS.js"></script>
<script>
  loadCSS("https://fonts.googleapis.com/css?family=Fira+Mono|Material+Icons");
</script>






  <script src="/js/toc.js"></script>











<script src="//cdn.jsdelivr.net/npm/@waline/client/dist/Waline.min.js"></script>





</head>
<body>
    	<div id="app"><div id="sideContainer" class="side-container">
    
    <a class="a-block nav-head false" href="https://yoziming.github.io/">
    
        <div class="nav-title">
            ÊüöÂ≠êËå∂ÂÆ§
        </div>
        
        <div class="nav-subtitle">
            Á¥ÄÈåÑËá™Â≠∏Â§ßÂ∞è‰∫ã
        </div>
        
    </a>

    <div class="nav-link-list">
        
        
            
            
            
                
            
            
            
            <a class="a-block nav-link-item active" href="/">
                È¶ñÈ†Åüè†
            </a>
            
        
            
            
            
            
            
            <a class="a-block nav-link-item false" href="/tags">
                Ê®ôÁ±§üè∑Ô∏è
            </a>
            
        
            
            
            
            
            
            <a class="a-block nav-link-item false" href="/categories">
                Á≥ªÂàóÊñáüìñ
            </a>
            
        
            
            
            
            
            
            <a class="a-block nav-link-item false" href="/about-me">
                ÈóúÊñºÊàëüê£
            </a>
            
        
    </div>

    

    <div class="nav-footer">
        
Hugo Theme <a href="https://github.com/amazingrise/hugo-theme-diary">Diary</a> by <a href="https://amazingrise.net">Rise</a>
<br>
ÁßªÊ§çËá™ <a href="https://mak1t0.cc/" target="_blank" rel="noreferrer noopener">Makito</a>'s <a href="https://github.com/SumiMakito/hexo-theme-journal/" target="_blank" rel="noreferrer noopener">Journal.</a> <br>
<br>

&copy;
	
	Yoziming
	

    </div>
    
</div><div id="extraContainer" class="extra-container">
    
    
    <div class="toc animated-visibility" :class="{ invisible: scrollY <= 140 }">


	<div class="toc-content">
	
		
		
		
		<center>- ÁõÆÈåÑ -</center>
		
		
		<ul>
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#webmvcconfigurer" onclick="onNavClick(`#webmvcconfigurer-nav`)" id="webmvcconfigurer-nav">
									WebMvcConfigurer
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e8%a8%bb%e5%86%8a" onclick="onNavClick(`#Ë®ªÂÜä-nav`)" id="Ë®ªÂÜä-nav">
									Ë®ªÂÜä
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#%e7%9f%a5%e8%ad%98%e9%bb%9e" onclick="onNavClick(`#Áü•Ë≠òÈªû-nav`)" id="Áü•Ë≠òÈªû-nav">
									Áü•Ë≠òÈªû
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#%e7%99%bb%e5%85%a5" onclick="onNavClick(`#ÁôªÂÖ•-nav`)" id="ÁôªÂÖ•-nav">
									ÁôªÂÖ•
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#%e7%ac%ac%e4%b8%89%e6%96%b9%e7%99%bb%e5%85%a5" onclick="onNavClick(`#Á¨¨‰∏âÊñπÁôªÂÖ•-nav`)" id="Á¨¨‰∏âÊñπÁôªÂÖ•-nav">
									Á¨¨‰∏âÊñπÁôªÂÖ•
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#session%e5%85%b1%e4%ba%ab%e5%95%8f%e9%a1%8c" onclick="onNavClick(`#sessionÂÖ±‰∫´ÂïèÈ°å-nav`)" id="sessionÂÖ±‰∫´ÂïèÈ°å-nav">
									sessionÂÖ±‰∫´ÂïèÈ°å
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#spring-session" onclick="onNavClick(`#spring-session-nav`)" id="spring-session-nav">
									Spring Session
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#%e7%b7%a8%e7%a2%bc%e5%95%8f%e9%a1%8c" onclick="onNavClick(`#Á∑®Á¢ºÂïèÈ°å-nav`)" id="Á∑®Á¢ºÂïèÈ°å-nav">
									Á∑®Á¢ºÂïèÈ°å
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e4%bd%9c%e7%94%a8%e5%9f%9f%e5%95%8f%e9%a1%8c" onclick="onNavClick(`#‰ΩúÁî®ÂüüÂïèÈ°å-nav`)" id="‰ΩúÁî®ÂüüÂïèÈ°å-nav">
									‰ΩúÁî®ÂüüÂïèÈ°å
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e4%b8%80%e8%b5%b7%e8%a7%a3%e6%b1%ba" onclick="onNavClick(`#‰∏ÄËµ∑Ëß£Ê±∫-nav`)" id="‰∏ÄËµ∑Ëß£Ê±∫-nav">
									‰∏ÄËµ∑Ëß£Ê±∫
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e6%a0%b8%e5%bf%83%e5%8e%9f%e7%90%86" onclick="onNavClick(`#Ê†∏ÂøÉÂéüÁêÜ-nav`)" id="Ê†∏ÂøÉÂéüÁêÜ-nav">
									Ê†∏ÂøÉÂéüÁêÜ
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%ae%8c%e5%96%84%e7%99%bb%e5%85%a5%e5%8a%9f%e8%83%bd" onclick="onNavClick(`#ÂÆåÂñÑÁôªÂÖ•ÂäüËÉΩ-nav`)" id="ÂÆåÂñÑÁôªÂÖ•ÂäüËÉΩ-nav">
									ÂÆåÂñÑÁôªÂÖ•ÂäüËÉΩ
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#%e5%96%ae%e9%bb%9e%e7%99%bb%e5%85%a5" onclick="onNavClick(`#ÂñÆÈªûÁôªÂÖ•-nav`)" id="ÂñÆÈªûÁôªÂÖ•-nav">
									ÂñÆÈªûÁôªÂÖ•
								</a>
							</li>
						
						
					
				
			
		</ul>
	</div>

</div>
    
    <div class="pagination">
        <a id="globalBackToTop" class="pagination-action animated-visibility" href="#top" :class="{ invisible: scrollY == 0 }">
            <i class="material-icons pagination-action-icon">
                keyboard_arrow_up
            </i>
        </a>
        
        <a type="button" class="pagination-action" id="darkModeToggleButton">
            <span class="material-icons pagination-action-icon" id="darkModeToggleIcon">
                dark_mode
            </span>
        </a>
        
        
    </div>
</div>
<div class="single-column-drawer-container" id="drawer"
     v-bind:class="{ 'single-column-drawer-container-active': isDrawerOpen }">
    <div class="drawer-content">
        <div class="drawer-menu">
            
            
            
                
                
                
                    
                
                
                
                <a class="a-block drawer-menu-item active" href="/">
                    È¶ñÈ†Åüè†
                </a>
                
            
                
                
                
                
                
                <a class="a-block drawer-menu-item false" href="/tags">
                    Ê®ôÁ±§üè∑Ô∏è
                </a>
                
            
                
                
                
                
                
                <a class="a-block drawer-menu-item false" href="/categories">
                    Á≥ªÂàóÊñáüìñ
                </a>
                
            
                
                
                
                
                
                <a class="a-block drawer-menu-item false" href="/about-me">
                    ÈóúÊñºÊàëüê£
                </a>
                
            
            
            <div class="toc">


	<div class="toc-content">
	
		
		
		
		<center>- ÁõÆÈåÑ -</center>
		
		
		<ul>
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#webmvcconfigurer" onclick="onNavClick(`#webmvcconfigurer-nav`)" id="webmvcconfigurer-nav">
									WebMvcConfigurer
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e8%a8%bb%e5%86%8a" onclick="onNavClick(`#Ë®ªÂÜä-nav`)" id="Ë®ªÂÜä-nav">
									Ë®ªÂÜä
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#%e7%9f%a5%e8%ad%98%e9%bb%9e" onclick="onNavClick(`#Áü•Ë≠òÈªû-nav`)" id="Áü•Ë≠òÈªû-nav">
									Áü•Ë≠òÈªû
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#%e7%99%bb%e5%85%a5" onclick="onNavClick(`#ÁôªÂÖ•-nav`)" id="ÁôªÂÖ•-nav">
									ÁôªÂÖ•
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#%e7%ac%ac%e4%b8%89%e6%96%b9%e7%99%bb%e5%85%a5" onclick="onNavClick(`#Á¨¨‰∏âÊñπÁôªÂÖ•-nav`)" id="Á¨¨‰∏âÊñπÁôªÂÖ•-nav">
									Á¨¨‰∏âÊñπÁôªÂÖ•
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#session%e5%85%b1%e4%ba%ab%e5%95%8f%e9%a1%8c" onclick="onNavClick(`#sessionÂÖ±‰∫´ÂïèÈ°å-nav`)" id="sessionÂÖ±‰∫´ÂïèÈ°å-nav">
									sessionÂÖ±‰∫´ÂïèÈ°å
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#spring-session" onclick="onNavClick(`#spring-session-nav`)" id="spring-session-nav">
									Spring Session
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#%e7%b7%a8%e7%a2%bc%e5%95%8f%e9%a1%8c" onclick="onNavClick(`#Á∑®Á¢ºÂïèÈ°å-nav`)" id="Á∑®Á¢ºÂïèÈ°å-nav">
									Á∑®Á¢ºÂïèÈ°å
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e4%bd%9c%e7%94%a8%e5%9f%9f%e5%95%8f%e9%a1%8c" onclick="onNavClick(`#‰ΩúÁî®ÂüüÂïèÈ°å-nav`)" id="‰ΩúÁî®ÂüüÂïèÈ°å-nav">
									‰ΩúÁî®ÂüüÂïèÈ°å
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e4%b8%80%e8%b5%b7%e8%a7%a3%e6%b1%ba" onclick="onNavClick(`#‰∏ÄËµ∑Ëß£Ê±∫-nav`)" id="‰∏ÄËµ∑Ëß£Ê±∫-nav">
									‰∏ÄËµ∑Ëß£Ê±∫
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e6%a0%b8%e5%bf%83%e5%8e%9f%e7%90%86" onclick="onNavClick(`#Ê†∏ÂøÉÂéüÁêÜ-nav`)" id="Ê†∏ÂøÉÂéüÁêÜ-nav">
									Ê†∏ÂøÉÂéüÁêÜ
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%ae%8c%e5%96%84%e7%99%bb%e5%85%a5%e5%8a%9f%e8%83%bd" onclick="onNavClick(`#ÂÆåÂñÑÁôªÂÖ•ÂäüËÉΩ-nav`)" id="ÂÆåÂñÑÁôªÂÖ•ÂäüËÉΩ-nav">
									ÂÆåÂñÑÁôªÂÖ•ÂäüËÉΩ
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#%e5%96%ae%e9%bb%9e%e7%99%bb%e5%85%a5" onclick="onNavClick(`#ÂñÆÈªûÁôªÂÖ•-nav`)" id="ÂñÆÈªûÁôªÂÖ•-nav">
									ÂñÆÈªûÁôªÂÖ•
								</a>
							</li>
						
						
					
				
			
		</ul>
	</div>

</div>
            
        </div>
    </div>
</div>
<transition name="fade">
    <div id="drawer-mask" v-bind:class="{ 'single-column-drawer-mask': mounted }" v-if="isDrawerOpen" v-on:click="toggleDrawer"></div>
</transition>
<nav id="navBar" class="navbar sticky-top navbar-light single-column-nav-container">
    <div id="navBackground" class="nav-background"></div>
    <div class="container container-narrow nav-content">
        <button id="nav_dropdown_btn" class="nav-dropdown-toggle" type="button" v-on:click="toggleDrawer">
            <i class="material-icons">
                menu
            </i>
        </button>
        <a id="navTitle" class="navbar-brand" href="https://yoziming.github.io/">
            ÊüöÂ≠êËå∂ÂÆ§
        </a>
        
        <button type="button" class="nav-darkmode-toggle" id="darkModeToggleButton2">
            <i class="material-icons" id="darkModeToggleIcon2">
                dark_mode
            </i>
        </button>
        
    </div>
</nav>
<div class="single-column-header-container" id="pageHead"
     v-bind:style="{ transform: 'translateZ(0px) translateY('+.3*scrollY+'px)', opacity: 1-navOpacity }">
    <a href="https://yoziming.github.io/">
        <div class="single-column-header-title">ÊüöÂ≠êËå∂ÂÆ§</div>
        
        <div class="single-column-header-subtitle">Á¥ÄÈåÑËá™Â≠∏Â§ßÂ∞è‰∫ã</div>
        

    </a>
</div>

            <div id="content">
                <div id="streamContainer" class="stream-container">

    <div class="post-list-container post-list-container-shadow">
        <div class="post">
            
            
            
                
            

            <div class="post-head-wrapper"
                
                    
                    
                    style="background-image: url('https://yoziming.github.io/images/gulimall.png')"
                    
                
            >
                <div class="post-title">
                    Ë®ªÂÜä„ÄÅÁôªÂÖ•ËàáSpring Session
                    
                    <div class="post-subtitle">
                        SpringBootÂæÆÊúçÂãôÈ†ÖÁõÆÁ≠ÜË®ò-16
                    </div>
                    
                    <div class="post-meta">
                        
                        <time itemprop="datePublished">
                            2022-02-02 00:00
                        </time>
                        

                        
                            <i class="material-icons" style="">folder</i>
                                <a href="/categories/java%E5%BE%AE%E6%9C%8D%E5%8B%99%E5%B0%88%E6%A1%88">JavaÂæÆÊúçÂãôÂ∞àÊ°à</a>
                                &nbsp;
                        

                        
                            <i class="material-icons" style="">label</i>
                            
                                <a href="/tags/java">Java</a>
                                &nbsp;
                            
                        
                        
                    </div>
                </div>
            </div>
            
            <div class="post-body-wrapper">
                
                <div class="post-body" v-pre>
                
                    <h2 id="webmvcconfigurer">WebMvcConfigurer</h2>
<blockquote>
<p>ÂèÉËÄÉ <a href="https://blog.csdn.net/pan_junbiao/article/details/120039885">https://blog.csdn.net/pan_junbiao/article/details/120039885</a></p>
</blockquote>
<ul>
<li>Ë§áÁøíSpringMVC</li>
<li>WebMvcConfigurerÊòØ‰∏ÄÂÄãÊé•Âè£ÔºåÁî®JavaBeanÁöÑÊñπÂºè‰ª£Êõøweb.xmlÔºåÂ∏∏Áî®Êñº:</li>
<li>ÊîîÊà™Âô®Ôºå‰æãÂ¶Ç:</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#707a7c">@Override</span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">addInterceptors</span>(InterceptorRegistry registry) {
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">super</span>.<span style="color:#658b00">addInterceptors</span>(registry);
</span></span><span style="display:flex;"><span>    registry.<span style="color:#658b00">addInterceptor</span>(<span style="color:#8b008b;font-weight:bold">new</span> TestInterceptor()).<span style="color:#658b00">addPathPatterns</span>(<span style="color:#cd5555">&#34;/**&#34;</span>).<span style="color:#658b00">excludePathPatterns</span>(<span style="color:#cd5555">&#34;/emp/toLogin&#34;</span>,<span style="color:#cd5555">&#34;/emp/login&#34;</span>,<span style="color:#cd5555">&#34;/js/**&#34;</span>,<span style="color:#cd5555">&#34;/css/**&#34;</span>,<span style="color:#cd5555">&#34;/images/**&#34;</span>);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ul>
<li>Ë∑®ÂüüË®≠ÂÆöÔºå‰æãÂ¶Ç:</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#228b22">// Ë∑®Âüü
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span><span style="color:#707a7c">@Override</span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">addCorsMappings</span>(CorsRegistry registry) {
</span></span><span style="display:flex;"><span>    registry.<span style="color:#658b00">addMapping</span>(<span style="color:#cd5555">&#34;/**&#34;</span>)
</span></span><span style="display:flex;"><span>            .<span style="color:#658b00">allowedOrigins</span>(<span style="color:#cd5555">&#34;*&#34;</span>)  <span style="color:#228b22">//ÊµèËßàÂô®ÂÖÅËÆ∏ÊâÄÊúâÁöÑÂüüËÆøÈóÆ / Ê≥®ÊÑè * ‰∏çËÉΩÊª°Ë∂≥Â∏¶ÊúâcookieÁöÑËÆøÈóÆ,Origin ÂøÖÈ°ªÊòØÂÖ®ÂåπÈÖç
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>            .<span style="color:#658b00">allowCredentials</span>(<span style="color:#8b008b;font-weight:bold">true</span>)   <span style="color:#228b22">// ÂÖÅËÆ∏Â∏¶cookieËÆøÈóÆ
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>            .<span style="color:#658b00">allowedMethods</span>(<span style="color:#cd5555">&#34;GET&#34;</span>, <span style="color:#cd5555">&#34;POST&#34;</span>, <span style="color:#cd5555">&#34;PUT&#34;</span>, <span style="color:#cd5555">&#34;DELETE&#34;</span>, <span style="color:#cd5555">&#34;OPTIONS&#34;</span>)
</span></span><span style="display:flex;"><span>            .<span style="color:#658b00">allowedHeaders</span>(<span style="color:#cd5555">&#34;token&#34;</span>)
</span></span><span style="display:flex;"><span>            .<span style="color:#658b00">maxAge</span>(3600);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><blockquote>
<p>Êõ¥Â§öÈóúÊñºË∑®ÂüüÔºåÂèÉËÄÉ <a href="https://segmentfault.com/a/1190000019485883">https://segmentfault.com/a/1190000019485883</a></p>
</blockquote>
<ul>
<li>Êò†Â∞ÑhtmlÈ†ÅÈù¢
<ul>
<li>ÂâçÂæåÁ∂¥‰∏ÄÊ®£Áî±thymeleafÂä†‰∏ä</li>
</ul>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#707a7c">@Configuration</span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">class</span> <span style="color:#008b45;font-weight:bold">MallWebConfig</span> <span style="color:#8b008b;font-weight:bold">implements</span> WebMvcConfigurer {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">// ViewÊò†Â∞ÑÔºåÁúÅ‰∏ãÈÄ†controller‰∏ÄÂÄã‰∏ÄÂÄãË®≠ÂÆö
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>    <span style="color:#707a7c">@Override</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">addViewControllers</span>(ViewControllerRegistry registry) {
</span></span><span style="display:flex;"><span>        registry.<span style="color:#658b00">addViewController</span>(<span style="color:#cd5555">&#34;/&#34;</span>).<span style="color:#658b00">setViewName</span>(<span style="color:#cd5555">&#34;login&#34;</span>);
</span></span><span style="display:flex;"><span>        registry.<span style="color:#658b00">addViewController</span>(<span style="color:#cd5555">&#34;/login.html&#34;</span>).<span style="color:#658b00">setViewName</span>(<span style="color:#cd5555">&#34;login&#34;</span>);
</span></span><span style="display:flex;"><span>        registry.<span style="color:#658b00">addViewController</span>(<span style="color:#cd5555">&#34;/reg.html&#34;</span>).<span style="color:#658b00">setViewName</span>(<span style="color:#cd5555">&#34;reg&#34;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>/* Áõ∏Áï∂Êñº
</span></span><span style="display:flex;"><span><span style="color:#707a7c">@GetMapping</span>(value = <span style="color:#cd5555">&#34;/login.html&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">public</span> String <span style="color:#008b45">loginPage</span>() {
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">return</span> <span style="color:#cd5555">&#34;login&#34;</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="Ë®ªÂÜä">Ë®ªÂÜä</h2>
<ul>
<li>LoginController.java</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#228b22">// Ë®ªÂÜä
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span><span style="color:#707a7c">@PostMapping</span>(value = <span style="color:#cd5555">&#34;/register&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">public</span> String <span style="color:#008b45">register</span>(<span style="color:#707a7c">@Valid</span> UserRegisterVo vos, BindingResult result, RedirectAttributes attributes) {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">// Â¶ÇÊûúÊúâÈåØË™§ÂõûÂà∞Ë®ªÂÜäÈ†ÅÈù¢
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>    <span style="color:#8b008b;font-weight:bold">if</span> (result.<span style="color:#658b00">hasErrors</span>()) {
</span></span><span style="display:flex;"><span>        Map&lt;String, String&gt; errors =
</span></span><span style="display:flex;"><span>                result.<span style="color:#658b00">getFieldErrors</span>().<span style="color:#658b00">stream</span>().<span style="color:#658b00">collect</span>(Collectors.<span style="color:#658b00">toMap</span>(FieldError::getField,
</span></span><span style="display:flex;"><span>                        FieldError::getDefaultMessage));
</span></span><span style="display:flex;"><span>        attributes.<span style="color:#658b00">addAttribute</span>(<span style="color:#cd5555">&#34;errors&#34;</span>, errors);
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">return</span> <span style="color:#cd5555">&#34;redirect:http://auth.mall.com/reg.html&#34;</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">// ÂâçÁ´ØÈ©óË≠âË¢´ÁπûÈÅéÔºåËã•ÂÇ≥Á©∫ÂÄºËÆì‰ªñËøîÂõû
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>    <span style="color:#8b008b;font-weight:bold">if</span> (vos.<span style="color:#658b00">getPassword</span>().<span style="color:#658b00">isEmpty</span>() || vos.<span style="color:#658b00">getCode</span>().<span style="color:#658b00">isEmpty</span>() || vos.<span style="color:#658b00">getUserName</span>().<span style="color:#658b00">isEmpty</span>() || vos.<span style="color:#658b00">getPhone</span>().<span style="color:#658b00">isEmpty</span>()) {
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">return</span> <span style="color:#cd5555">&#34;redirect:http://auth.mall.com/reg.html&#34;</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">// Áç≤ÂèñÈ©óË≠âÁ¢º
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>    String code = vos.<span style="color:#658b00">getCode</span>();
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">//È©óË≠âÁ¢ºÈÄöÈÅéÔºåÁúüÊ≠£Ë®ªÂÜäÔºåË™øÁî®ÈÅ†Á®ãÊúçÂãôÈÄ≤Ë°åË®ªÂÜäÊúÉÂì°
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>    <span style="color:#8b008b;font-weight:bold">if</span> (code.<span style="color:#658b00">equals</span>(<span style="color:#cd5555">&#34;1234&#34;</span>)) {
</span></span><span style="display:flex;"><span>        R register = memberFeignService.<span style="color:#658b00">register</span>(vos);
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">if</span> (register.<span style="color:#658b00">getCode</span>() == 0) {
</span></span><span style="display:flex;"><span>            <span style="color:#228b22">//ÊàêÂäü
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>            <span style="color:#8b008b;font-weight:bold">return</span> <span style="color:#cd5555">&#34;redirect:http://auth.mall.com/login.html&#34;</span>;
</span></span><span style="display:flex;"><span>        } <span style="color:#8b008b;font-weight:bold">else</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#228b22">//Â§±Êïó
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>            Map&lt;String, String&gt; errors = <span style="color:#8b008b;font-weight:bold">new</span> HashMap&lt;&gt;();
</span></span><span style="display:flex;"><span>            errors.<span style="color:#658b00">put</span>(<span style="color:#cd5555">&#34;msg&#34;</span>, register.<span style="color:#658b00">getData</span>(<span style="color:#cd5555">&#34;msg&#34;</span>, <span style="color:#8b008b;font-weight:bold">new</span> TypeReference&lt;String&gt;() {
</span></span><span style="display:flex;"><span>            }));
</span></span><span style="display:flex;"><span>            attributes.<span style="color:#658b00">addFlashAttribute</span>(<span style="color:#cd5555">&#34;errors&#34;</span>, errors);
</span></span><span style="display:flex;"><span>            <span style="color:#8b008b;font-weight:bold">return</span> <span style="color:#cd5555">&#34;redirect:http://auth.mall.com/reg.html&#34;</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    } <span style="color:#8b008b;font-weight:bold">else</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#228b22">//È©óË≠âÁ¢ºÈåØË™§
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>        Map&lt;String, String&gt; errors = <span style="color:#8b008b;font-weight:bold">new</span> HashMap&lt;&gt;();
</span></span><span style="display:flex;"><span>        errors.<span style="color:#658b00">put</span>(<span style="color:#cd5555">&#34;code&#34;</span>, <span style="color:#cd5555">&#34;È©óË≠âÁ¢ºÈåØË™§&#34;</span>);
</span></span><span style="display:flex;"><span>        attributes.<span style="color:#658b00">addFlashAttribute</span>(<span style="color:#cd5555">&#34;errors&#34;</span>, errors);
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">return</span> <span style="color:#cd5555">&#34;redirect:http://auth.mall.com/reg.html&#34;</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ul>
<li>
<p>Áü•Ë≠òÈªû:</p>
<ul>
<li>
<p>Áî®ÊããÂá∫Áï∞Â∏∏ÁöÑÊñπÂºèÂëäÁü•ÊòØÂê¶ÈáçË§áË®ªÂÜä</p>
</li>
<li>
<p>Áî®MD5Âä†ÈπΩÂä†ÂØÜÔºåÂ•ΩËôï:</p>
<ul>
<li>Âø´ÈÄü„ÄÅÊäóÊîπ(Èõ™Â¥©ÊïàÊáâÔºåÂè™Ë¶ÅÊúâÂéüÂßãË≥áÊñô‰ªª‰ΩïËÆäÂåñÁÆóÂá∫ÁöÑMD5ÈÉΩÊúÉÂ§©Â∑ÆÂú∞Âà•)„ÄÅ‰∏çÂèØÈÄÜ</li>
<li>‰ΩÜÊòØÂèØ‰ª•Êö¥ÂäõÁ†¥Ëß£ÔºåÊâÄ‰ª•Ë¶ÅÂä†ÈπΩ</li>
</ul>
</li>
</ul>
</li>
<li>
<p>MemberController.java</p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#707a7c">@PostMapping</span>(value = <span style="color:#cd5555">&#34;/register&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">public</span> R <span style="color:#008b45">register</span>(<span style="color:#707a7c">@RequestBody</span> MemberUserRegisterVo vo) {
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">try</span> {
</span></span><span style="display:flex;"><span>        memberService.<span style="color:#658b00">register</span>(vo);
</span></span><span style="display:flex;"><span>    } <span style="color:#8b008b;font-weight:bold">catch</span> (PhoneException e) {
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">return</span> R.<span style="color:#658b00">error</span>(BizCodeEnum.<span style="color:#658b00">PHONE_EXIST_EXCEPTION</span>.<span style="color:#658b00">getCode</span>(), BizCodeEnum.<span style="color:#658b00">PHONE_EXIST_EXCEPTION</span>.<span style="color:#658b00">getMessage</span>());
</span></span><span style="display:flex;"><span>    } <span style="color:#8b008b;font-weight:bold">catch</span> (UsernameException e) {
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">return</span> R.<span style="color:#658b00">error</span>(BizCodeEnum.<span style="color:#658b00">USER_EXIST_EXCEPTION</span>.<span style="color:#658b00">getCode</span>(), BizCodeEnum.<span style="color:#658b00">USER_EXIST_EXCEPTION</span>.<span style="color:#658b00">getMessage</span>());
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">return</span> R.<span style="color:#658b00">ok</span>();
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ul>
<li>MemberServiceImpl.java
<ul>
<li>SpringÁöÑBCryptPasswordEncoderÂ∑≤Á∂ìËá™ÂãïÂä†ÈπΩ‰∫Ü</li>
</ul>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#707a7c">@Override</span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">register</span>(MemberUserRegisterVo vo) {
</span></span><span style="display:flex;"><span>    MemberEntity memberEntity = <span style="color:#8b008b;font-weight:bold">new</span> MemberEntity();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">// Ë®≠ÁΩÆÁ≠âÁ¥öÁÇ∫ÊôÆÈÄöÊúÉÂì°
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>    MemberLevelEntity levelEntity = memberLevelDao.<span style="color:#658b00">getDefaultLevel</span>();
</span></span><span style="display:flex;"><span>    memberEntity.<span style="color:#658b00">setLevelId</span>(levelEntity.<span style="color:#658b00">getId</span>());
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">// Ê™¢Êü•Áî®Êà∂ÂêçÂíåÊâãÊ©üËôüÊòØÂê¶ÂîØ‰∏ÄÔºåÂèØËÉΩÊããÂá∫Áï∞Â∏∏
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>    checkPhoneUnique(vo.<span style="color:#658b00">getPhone</span>());
</span></span><span style="display:flex;"><span>    checkUserNameUnique(vo.<span style="color:#658b00">getUserName</span>());
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">// Ë®≠ÂÆöÂ∏≥ËôüÂØÜÁ¢º
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>    memberEntity.<span style="color:#658b00">setNickname</span>(vo.<span style="color:#658b00">getUserName</span>());
</span></span><span style="display:flex;"><span>    memberEntity.<span style="color:#658b00">setUsername</span>(vo.<span style="color:#658b00">getUserName</span>());
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">// ÂØÜÁ¢ºÈÄ≤Ë°åMD5Âä†ÂØÜ
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>    BCryptPasswordEncoder bCryptPasswordEncoder = <span style="color:#8b008b;font-weight:bold">new</span> BCryptPasswordEncoder();
</span></span><span style="display:flex;"><span>    String encode = bCryptPasswordEncoder.<span style="color:#658b00">encode</span>(vo.<span style="color:#658b00">getPassword</span>());
</span></span><span style="display:flex;"><span>    memberEntity.<span style="color:#658b00">setPassword</span>(encode);
</span></span><span style="display:flex;"><span>    memberEntity.<span style="color:#658b00">setMobile</span>(vo.<span style="color:#658b00">getPhone</span>());
</span></span><span style="display:flex;"><span>    memberEntity.<span style="color:#658b00">setGender</span>(0);
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">// memberEntity.setCreateTime(new Date());
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>    <span style="color:#228b22">// ‰øùÂ≠ò
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>    baseMapper.<span style="color:#658b00">insert</span>(memberEntity);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#707a7c">@Override</span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">checkPhoneUnique</span>(String phone) <span style="color:#8b008b;font-weight:bold">throws</span> PhoneException {
</span></span><span style="display:flex;"><span>    Long phoneCount = baseMapper.<span style="color:#658b00">selectCount</span>(<span style="color:#8b008b;font-weight:bold">new</span> QueryWrapper&lt;MemberEntity&gt;().<span style="color:#658b00">eq</span>(<span style="color:#cd5555">&#34;mobile&#34;</span>, phone));
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">if</span> (phoneCount &gt; 0) {
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">throw</span> <span style="color:#8b008b;font-weight:bold">new</span> PhoneException();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#707a7c">@Override</span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">checkUserNameUnique</span>(String userName) <span style="color:#8b008b;font-weight:bold">throws</span> UsernameException {
</span></span><span style="display:flex;"><span>    Long usernameCount = baseMapper.<span style="color:#658b00">selectCount</span>(<span style="color:#8b008b;font-weight:bold">new</span> QueryWrapper&lt;MemberEntity&gt;().<span style="color:#658b00">eq</span>(<span style="color:#cd5555">&#34;username&#34;</span>, userName));
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">if</span> (usernameCount &gt; 0) {
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">throw</span> <span style="color:#8b008b;font-weight:bold">new</span> UsernameException();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="Áü•Ë≠òÈªû">Áü•Ë≠òÈªû</h3>
<blockquote>
<p>addAttributeËàáaddFlashAttributeÁöÑÂçÄÂà•</p>
</blockquote>
<pre tabindex="0"><code>attr.addAttribute(‚Äúparam‚Äù, value);
</code></pre><ul>
<li>ÈÄôÁ®ÆÊñπÂºèÂ∞±Áõ∏Áï∂ÊñºÈáçÂÆöÂêë‰πãÂæåÔºåÂú®urlÂæåÈù¢ÊãºÊé•ÂèÉÊï∏ÔºåÈÄôÊ®£Âú®ÈáçÂÆöÂêë‰πãÂæåÁöÑÈ†ÅÈù¢ÊàñËÄÖÊéßÂà∂Âô®ÂÜçÂéªÁç≤ÂèñurlÂæåÈù¢ÁöÑÂèÉÊï∏Â∞±ÂèØ‰ª•‰∫ÜÔºå‰ΩÜÈÄôÂÄãÊñπÂºèÂõ†ÁÇ∫ÊòØÂú®urlÂæåÈù¢Ê∑ªÂä†ÂèÉÊï∏ÁöÑÊñπÂºèÔºåÊâÄ‰ª•Êö¥Èú≤‰∫ÜÂèÉÊï∏ÔºåÊúâÈ¢®Èö™</li>
</ul>
<pre tabindex="0"><code>attr.addFlashAttribute(‚Äúparam‚Äù, value);
</code></pre><ul>
<li>ÈÄôÁ®ÆÊñπÂºè‰πüËÉΩÈÅîÂà∞ÈáçÊñ∞ÂêëÂ∏∂ÂèÉÔºåËÄå‰∏îËÉΩÈö±ËóèÂèÉÊï∏ÔºåÂÖ∂ÂéüÁêÜÂ∞±ÊòØÊîæÂà∞session‰∏≠ÔºåsessionÂú®Ë∑≥Âà∞È†ÅÈù¢ÂêéÈ¶¨‰∏äÁßªÈô§Â∞çË±°</li>
</ul>
<h2 id="ÁôªÂÖ•">ÁôªÂÖ•</h2>
<ul>
<li>LoginController.java
<ul>
<li><code>AuthServerConstant.LOGIN_USER</code>ÂÖ∂ÂØ¶Â∞±ÊòØ<code>&quot;loginUser&quot;</code>ÔºåÊîæÊàêÂ∏∏Êï∏ÊòØÁÇ∫‰∫ÜÈÅøÂÖç‰ΩøÁî®È≠îÊ≥ïÂÄº</li>
</ul>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#707a7c">@PostMapping</span>(value = <span style="color:#cd5555">&#34;/login&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">public</span> String <span style="color:#008b45">login</span>(UserLoginVo vo, RedirectAttributes attributes, HttpSession session) {
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">// ÈÅ†Á®ãË™øÁî®memberÁöÑÈ©óË≠âÂ∏≥ËôüÂØÜÁ¢ºÊúçÂãô
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>    R login = memberFeignService.<span style="color:#658b00">login</span>(vo);
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">if</span> (login.<span style="color:#658b00">getCode</span>() == 0) {
</span></span><span style="display:flex;"><span>        MemberResponseVo data = login.<span style="color:#658b00">getData</span>(<span style="color:#cd5555">&#34;data&#34;</span>, <span style="color:#8b008b;font-weight:bold">new</span> TypeReference&lt;MemberResponseVo&gt;() {
</span></span><span style="display:flex;"><span>        });
</span></span><span style="display:flex;"><span>        System.<span style="color:#658b00">out</span>.<span style="color:#658b00">println</span>(<span style="color:#cd5555">&#34;Áî®Êà∂&#34;</span>+data.<span style="color:#658b00">getUsername</span>()+<span style="color:#cd5555">&#34;ÁôªÂÖ•ÊàêÂäü&#34;</span>);
</span></span><span style="display:flex;"><span>        session.<span style="color:#658b00">setAttribute</span>(AuthServerConstant.<span style="color:#658b00">LOGIN_USER</span>, data);
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">return</span> <span style="color:#cd5555">&#34;redirect:http://mall.com&#34;</span>;
</span></span><span style="display:flex;"><span>    } <span style="color:#8b008b;font-weight:bold">else</span> {
</span></span><span style="display:flex;"><span>        Map&lt;String, String&gt; errors = <span style="color:#8b008b;font-weight:bold">new</span> HashMap&lt;&gt;();
</span></span><span style="display:flex;"><span>        errors.<span style="color:#658b00">put</span>(<span style="color:#cd5555">&#34;msg&#34;</span>, login.<span style="color:#658b00">getData</span>(<span style="color:#cd5555">&#34;msg&#34;</span>, <span style="color:#8b008b;font-weight:bold">new</span> TypeReference&lt;String&gt;() {
</span></span><span style="display:flex;"><span>        }));
</span></span><span style="display:flex;"><span>        attributes.<span style="color:#658b00">addFlashAttribute</span>(<span style="color:#cd5555">&#34;errors&#34;</span>, errors);
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">return</span> <span style="color:#cd5555">&#34;redirect:http://auth.mall.com/login.html&#34;</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ul>
<li>È©óË≠âÂ∏≥ËôüÂØÜÁ¢ºÂæàÁ∞°ÂñÆÂ∞±‰∏çË≤º‰∫ÜÔºåÊé•Ëëó‰∏ªË¶ÅËôïÁêÜSessionÁöÑÂïèÈ°å</li>
</ul>
<h3 id="Á¨¨‰∏âÊñπÁôªÂÖ•">Á¨¨‰∏âÊñπÁôªÂÖ•</h3>
<ul>
<li>Á¨¨‰∏âÊñπÁôªÂÖ•ÊàëËá™Â∑±Áî®googleË©¶‰∫ÜÈÉΩ‰∏çÊàêÂäüÔºå‰∏ªË¶ÅÂç°Âú®‰∏çÁü•ÈÅìrequestÁ∂≤ÂùÄÂà∞Â∫ïË©≤ÊÄéÂØ´</li>
</ul>
<p><img src="image-20220125222347983.png" alt="image-20220125222347983"></p>
<ul>
<li>ÊêúÊïôÂ≠∏ÊØîËºÉÂ§öÊòØÁî®spring securityÔºåÁÖßÊïôÂ≠∏ËÉΩÈÄ†‰∏ÄÂÄãÊñ∞ÁöÑLoginÈ†ÅÈù¢ÔºåÁµêÂêàËµ∑‰æÜÊêûÂçäÂ§©ÈÉΩÂ§±ÊïóÔºåÂîâÂÖàË∑≥ÈÅéÂêß</li>
</ul>
<h2 id="sessionÂÖ±‰∫´ÂïèÈ°å">sessionÂÖ±‰∫´ÂïèÈ°å</h2>
<ul>
<li>
<p>Â≠êÁ∂≤Âüü„ÄÅÂàÜÊï£ÂºèÊúçÂãôÁî®ÂÇ≥Áµ±sessionÊáâ‰ªò‰∏ç‰æÜÔºåÊúâÂπæÁ®ÆÂèØÈÅ∏ÊñπÊ°à</p>
</li>
<li>
<p>sessionË§áË£ΩÔºåÊØè‰∏ÄÂÄãsessionÈÉΩË§áË£ΩÂà∞ÊâÄÊúâwebserver‰∏≠ÔºåTomcat‰øÆÊîπÈÖçÁΩÆÊñá‰ª∂Â∞±ËÉΩËæ¶Âà∞</p>
<ul>
<li>Áº∫Èªû: ‰ΩîÁî®Â§ö</li>
</ul>
</li>
<li>
<p>ÂÆ¢Êà∑Á´ØÂ≠òÂÑ≤Ôºå‰øùÂ≠òÂú®cookie‰∏≠</p>
<ul>
<li>Áº∫Èªû: ÂÆâÂÖ®Èö±ÊÇ£(ÁØ°Êîπ)„ÄÅÁ∂≤Áµ°ÊµÅÈáè„ÄÅcookieÈï∑Â∫¶ÈôêÂà∂</li>
</ul>
</li>
<li>
<p>hash‰∏ÄËá¥ÊÄßÔºå‰æãÂ¶ÇÊãøÂÆ¢Êà∑Á´ØIP‰æÜË®àÁÆóÔºåÁÆóÂá∫‰æÜ‰∏ÄÊ®£Â∞±Ë≤†ËºâÂùáË°°ÂàÜÂà∞ÊåáÂÆöÁöÑ‰º∫ÊúçÂô®</p>
<ul>
<li>Áº∫Èªû: Ê∞¥Âπ≥Êì¥Â±ïÊúÉÂºïÁôºsessionÂ§±Êïà</li>
</ul>
</li>
<li>
<p>Áµ±‰∏ÄÂ≠òÂÑ≤Ôºå‰æãÂ¶ÇÊääsessionÂ≠òÂà∞redis</p>
<ul>
<li>Áº∫Èªû: redisÈÇÑÊòØÊØîË®òÊÜ∂È´îÊÖ¢ÔºåÂ§öÂ¢ûÊ∫ùÈÄöÊ∂àËÄóÔºå‰ΩÜÂïèÈ°å‰∏çÂ§ß</li>
</ul>
</li>
</ul>
<h1 id="spring-session">Spring Session</h1>
<blockquote>
<p>ÂÆòÊñπ <a href="https://docs.spring.io/spring-session/reference/samples.html">https://docs.spring.io/spring-session/reference/samples.html</a></p>
</blockquote>
<ul>
<li>SpringÈÉΩÂπ´‰Ω†ÊÉ≥Â•Ω‰∫ÜÔºåÂºïÂåÖÂêß</li>
</ul>
<pre tabindex="0"><code>&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.session&lt;/groupId&gt;
    &lt;artifactId&gt;spring-session-data-redis&lt;/artifactId&gt;
    &lt;version&gt;2.6.1&lt;/version&gt;
&lt;/dependency&gt;
</code></pre><ul>
<li>application.properties
<ul>
<li>ÈÇÑÂèØ‰ª•Ë®≠ÂÆöÈÅéÊúüÊôÇÈñìÁ≠âÁ≠âÔºåÈ†êË®≠ÊòØ30m</li>
</ul>
</li>
</ul>
<pre tabindex="0"><code>spring.session.store-type=redis
# Áï∂ÁÑ∂ÈÇÑË¶ÅË®≠ÂÆöredisÊâÄÂú®
spring.redis.host=localhost
spring.redis.port=6379
</code></pre><ul>
<li>Âà∞ÂïüÂãïÈ°ûË®ªËß£<code>@EnableRedisHttpSession</code></li>
</ul>
<p><img src="image-20220125201947928.png" alt="image-20220125201947928"></p>
<ul>
<li>Â∞áË¶ÅÂ≠òÈÄ≤sessionÁöÑbeanÂ∫èÂàóÂåñ</li>
</ul>
<p><img src="image-20220125204057093.png" alt="image-20220125204057093"></p>
<h2 id="Á∑®Á¢ºÂïèÈ°å">Á∑®Á¢ºÂïèÈ°å</h2>
<ul>
<li>ÈÄôÊ®£‰∏Ä‰æÜÂ≠òÊòØËÉΩÂ≠ò‰∫ÜÔºåÁÑ∂ËÄåÊòØÁ∑®Êàê‰∫åÈÄ≤Âà∂È°ûÂûãÔºåÈ°ØÁÑ∂‰∏çÂ•ΩÁî®ÔºåÊáâË©≤ÊîπÊàêJSON</li>
</ul>
<p><img src="image-20220125205905259.png" alt="image-20220125205905259"></p>
<h2 id="‰ΩúÁî®ÂüüÂïèÈ°å">‰ΩúÁî®ÂüüÂïèÈ°å</h2>
<ul>
<li>È†êË®≠ÁöÑsessionÊòØÊ†πÊìöÁï∂ÂâçÂüü(Âú®auth‰º∫ÊúçÂô®)Â≠òÁöÑÔºåÁï∂ÂõûÂà∞‰∏ªÁ∂≤ÂüüÊàñËΩâÂà∞ÂÖ∂‰ªñÂ≠êÁ∂≤ÂüüÂ∞±Áî®‰∏ç‰∫Ü</li>
</ul>
<p><img src="image-20220125210029897.png" alt="image-20220125210029897"></p>
<h2 id="‰∏ÄËµ∑Ëß£Ê±∫">‰∏ÄËµ∑Ëß£Ê±∫</h2>
<ul>
<li>MallSessionConfig.java</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#707a7c">@Configuration</span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">class</span> <span style="color:#008b45;font-weight:bold">MallSessionConfig</span> {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#707a7c">@Bean</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> CookieSerializer <span style="color:#008b45">cookieSerializer</span>() {
</span></span><span style="display:flex;"><span>        DefaultCookieSerializer cookieSerializer = <span style="color:#8b008b;font-weight:bold">new</span> DefaultCookieSerializer();
</span></span><span style="display:flex;"><span>        <span style="color:#228b22">// ÊîæÂ§ß‰ΩúÁî®Âüü
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>        cookieSerializer.<span style="color:#658b00">setDomainName</span>(<span style="color:#cd5555">&#34;mall.com&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#228b22">// Ëá™Ë®ÇÂêçÁ®±
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>        cookieSerializer.<span style="color:#658b00">setCookieName</span>(<span style="color:#cd5555">&#34;MALLSESSION&#34;</span>);
</span></span><span style="display:flex;"><span>        cookieSerializer.<span style="color:#658b00">setCookieMaxAge</span>(60 * 60 * 24 * 7);
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">return</span> cookieSerializer;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">// Êï¥ÊàêJSONÊ†ºÂºè
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>    <span style="color:#707a7c">@Bean</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">public</span> RedisSerializer&lt;Object&gt; <span style="color:#008b45">springSessionDefaultRedisSerializer</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">return</span> <span style="color:#8b008b;font-weight:bold">new</span> GenericJackson2JsonRedisSerializer();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ul>
<li>ÊàêÂäü!</li>
</ul>
<p><img src="image-20220125211255800.png" alt="image-20220125211255800"></p>
<h2 id="Ê†∏ÂøÉÂéüÁêÜ">Ê†∏ÂøÉÂéüÁêÜ</h2>
<blockquote>
<p>Ë£ùÈ£æËÄÖÊ®°ÂºèÔºåÂ∞±ÂÉèÈãºÈêµ‰∫∫Á©ø‰∏ä<em>ÂèçÊµ©ÂÖãË£ùÁî≤</em>ÔºåÊúâÈ°çÂ§ñÂ¢ûÂº∑‰ΩÜ‰ªçÁÑ∂‰øùÁïôÂéüÂßãÂäüËÉΩ</p>
</blockquote>
<ul>
<li><code>@EnablcRedisHttpSession</code>Â∞éÂÖ•RedisHttpSessionConfigurationÈÖçÁΩÆÈ°ûÔºåÂú®ÈÄôÂÄãÈÖçÁΩÆÈ°û‰∏≠Êúâ<code>SessionRepositoryFilter</code>ÈÅéÊøæÂô®</li>
<li>ÂéüÂßãÁöÑhttpË´ãÊ±ÇrequestÂíåÈüøÊáâresponseÁ∂ìÈÅéÊøæÂô®ÊîæË°åÂæåÔºåËÆäÊàê‰∫Ü<code>SessionRepositoryRequestWrapper</code>Ëàá<code>SessionRepositoryResponseWrapper</code></li>
<li>‰πãÂæåÊàëÂÄëÊìç‰ΩúsessionÂÖ∂ÂØ¶Â∞±ÊòØÊìç‰ΩúÈÄô‰∫õWrapperÔºåËÄåWrapperÊääÂéüÂßãÁöÑsessionÊñπÊ≥ïÈÉΩÈáçÂØ´(Âä†Êñô)‰∫ÜÔºå‰æãÂ¶ÇRedisHttpSessionÁöÑ<code>.getSession()</code>ÊñπÊ≥ïÂ∞±ÊòØÂéªredisÊâæÊù±Ë•ø</li>
<li>Spring SessionÂ∑≤Á∂ìËÄÉÊÖÆÈÅéÂêÑÁ®ÆÁº∫ÈªûÔºåÂè™Ë¶ÅÁÄèË¶ΩÂô®‰∏çÈóúÔºåÊúÉÁµ¶redis‰∏≠ÁöÑsessionËá™ÂãïÂª∂Êúü</li>
</ul>
<h2 id="ÂÆåÂñÑÁôªÂÖ•ÂäüËÉΩ">ÂÆåÂñÑÁôªÂÖ•ÂäüËÉΩ</h2>
<ul>
<li>Ê∑ªÂä†Spring Session‰æùË≥¥„ÄÅÂÅöÂ•ΩË®≠ÂÆöÔºåÁèæÂú®ProductÊ®°ÁµÑ„ÄÅSearchÊ®°ÁµÑ‰πüÈÉΩÂèØ‰ª•Ë™øÁî®ÂÖ±‰∫´ÁöÑsession‰∫Ü</li>
<li>‰øÆÊîπÂâçÁ´ØÈ†ÅÈù¢Ôºå‰æùÊìösessionÂà§Êñ∑ÊòØÂê¶Â∑≤ÁôªÂÖ•</li>
</ul>
<p><img src="image-20220125222040181.png" alt="image-20220125222040181"></p>
<ul>
<li>LoginController.java
<ul>
<li>Â∑≤Á∂ìÁôªÂÖ•ÁöÑ‰∫∫ÈÇÑÊÉ≥ÁôªÂÖ•Â∞±ËÆìÂÆÉË∑≥ËΩâ</li>
<li>Ë¶ÅÊää‰πãÂâçË®≠ÂÆöÁöÑViewÊò†Â∞ÑÈóúÊéâ</li>
</ul>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#228b22">/**
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"> * Âà§Êñ∑sessionÊòØÂê¶ÊúâloginUserÔºåÊ≤íÊúâÂ∞±Ë∑≥ËΩâÁôªÈåÑÈ†ÅÈù¢ÔºåÊúâÂ∞±Ë∑≥ËΩâÈ¶ñÈ†Å
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"> */</span>
</span></span><span style="display:flex;"><span><span style="color:#707a7c">@GetMapping</span>(value = <span style="color:#cd5555">&#34;/login.html&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">public</span> String <span style="color:#008b45">loginPage</span>(HttpSession session) {
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">// ÂæûsessionÂÖàÂèñÂá∫‰æÜÁî®Êà∂ÁöÑ‰ø°ÊÅØÔºåÂà§Êñ∑Áî®Êà∂ÊòØÂê¶Â∑≤Á∂ìÁôªÈåÑÈÅé‰∫Ü
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>    Object attribute = session.<span style="color:#658b00">getAttribute</span>(AuthServerConstant.<span style="color:#658b00">LOGIN_USER</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#228b22">// Â¶ÇÊûúÁî®Êà∂Ê≤íÁôªÈåÑÈÇ£Â∞±Ë∑≥ËΩâÂà∞ÁôªÈåÑÈ†ÅÈù¢
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>    <span style="color:#8b008b;font-weight:bold">if</span> (attribute == <span style="color:#8b008b;font-weight:bold">null</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">return</span> <span style="color:#cd5555">&#34;login&#34;</span>;
</span></span><span style="display:flex;"><span>    } <span style="color:#8b008b;font-weight:bold">else</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">return</span> <span style="color:#cd5555">&#34;redirect:http://mall.com&#34;</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#228b22">// ÁôªÂá∫
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span><span style="color:#707a7c">@GetMapping</span>(value = <span style="color:#cd5555">&#34;/loguot.html&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">public</span> String <span style="color:#008b45">logout</span>(HttpServletRequest request) {
</span></span><span style="display:flex;"><span>    request.<span style="color:#658b00">getSession</span>().<span style="color:#658b00">removeAttribute</span>(AuthServerConstant.<span style="color:#658b00">LOGIN_USER</span>);
</span></span><span style="display:flex;"><span>    request.<span style="color:#658b00">getSession</span>().<span style="color:#658b00">invalidate</span>();
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">return</span> <span style="color:#cd5555">&#34;redirect:http://mall.com&#34;</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h1 id="ÂñÆÈªûÁôªÂÖ•">ÂñÆÈªûÁôªÂÖ•</h1>
<blockquote>
<p>Single Sign OnÔºåÁ∞°Á®±SSO</p>
</blockquote>
<ul>
<li>Áî®Âú®‰∏çÂêåÂüüÂêçÔºåÂéüÁêÜÊòØÊúâ‰∏ÄÂÄã‰∏≠Â§ÆË™çË≠âÁ≥ªÁµ±Â∞àÈñÄËôïÁêÜÁôªÂÖ•</li>
</ul>
<p><img src="image-20220125224243309.png" alt="image-20220125224243309"></p>
<ul>
<li>ÊúâÂæàÂ§öÂØ¶ÁèæÊñπÂºèÔºåÊØîËºÉÂ∏∏Ë¶ãÊòØÁî®<strong>Token</strong></li>
<li>Êö´ÊôÇÊáâË©≤ÊòØÁî®‰∏ç‰∏äÔºåÂ∞±Âè™ÂÖà‰∫ÜËß£‰∏Ä‰∏ãÔºåÊúâÈúÄË¶ÅÂÜçÂõû‰æÜË£ú</li>
<li><a href="https://www.bilibili.com/video/BV1np4y1C7Yf?p=233">https://www.bilibili.com/video/BV1np4y1C7Yf?p=233</a></li>
</ul>

                    
                    <HR width="100%" id="EOF">
		    <p style="color:#777;">‰∏äÊ¨°‰øÆÊîπÊñº 2022-02-02</p>
                    
                </div>
            </div>
            
            
            <nav class="post-pagination">

                
                <a class="newer-posts" href="https://yoziming.github.io/post/220203-bitcoin/">
			‰∏ã‰∏ÄÁØá<br>ÂÄã‰∫∫Â∞çÂçÄÂ°äÈèàÁöÑÁôΩË©±ÁêÜËß£
                </a>
                
                
                
                <a class="older-posts" href="https://yoziming.github.io/post/220201-gulimall-15/">
			‰∏ä‰∏ÄÁØá<br>ÂïÜÂìÅË©≥ÊÉÖ
                </a>
                
            </nav>
            <div class="post-comment-wrapper">
                








<div id="waline"></div>
<script>
    new Waline({
        el: '#waline',
        path: location.pathname,
        serverURL: "https://waline-pn38gfwbz-yoziming.vercel.app/" ,
		lang: 'en-US',
		visitor: true,
		meta: ['nick', 'mail'],
    });
    </script>



            </div>
        </div>
    </div>


                    </div>
            </div><div id="single-column-footer">
Hugo Theme <a href="https://github.com/amazingrise/hugo-theme-diary">Diary</a> by <a href="https://amazingrise.net">Rise</a>
<br>
ÁßªÊ§çËá™ <a href="https://mak1t0.cc/" target="_blank" rel="noreferrer noopener">Makito</a>'s <a href="https://github.com/SumiMakito/hexo-theme-journal/" target="_blank" rel="noreferrer noopener">Journal.</a> <br>
<br>

&copy;
	
	Yoziming
	
</div>
            </div>
    
    <script src="/js/journal.js"></script>
    </body>
</html>
